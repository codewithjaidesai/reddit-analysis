<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reddit Insight Analyzer</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç Reddit Insight Analyzer</h1>
            <p class="subtitle">Extract evidence-based insights from Reddit discussions</p>
        </header>

        <main>
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" onclick="switchTab('url')">
                    üîó Analyze URL
                </button>
                <button class="tab-btn" onclick="switchTab('topic')">
                    üîç Topic Search
                </button>
                <button class="tab-btn" onclick="switchTab('subreddit')">
                    üìä Subreddit Analysis
                </button>
            </div>

            <!-- Tab 1: URL Analysis -->
            <div id="urlTab" class="tab-content active">
                <div class="input-section">
                    <h2>Analyze Single Reddit Post</h2>
                    <div class="input-group">
                        <input
                            type="text"
                            id="redditUrl"
                            placeholder="Paste Reddit post URL here..."
                            class="url-input"
                        />
                        <button id="analyzeBtn" class="analyze-btn" onclick="handleAnalyzeUrl()">
                            <span class="btn-text">Analyze</span>
                            <span class="btn-loader" style="display: none;">
                                <span class="spinner"></span>
                            </span>
                        </button>
                    </div>
                    <p class="hint">Example: https://www.reddit.com/r/AskReddit/comments/...</p>
                </div>
            </div>

            <!-- Tab 2: Topic Search -->
            <div id="topicTab" class="tab-content" style="display: none;">
                <div class="input-section">
                    <h2>Search Reddit by Topic</h2>
                    <div class="search-form">
                        <div class="input-group">
                            <input
                                type="text"
                                id="topicQuery"
                                placeholder="Enter topic or keywords..."
                                class="url-input"
                            />
                        </div>
                        <div class="filter-row">
                            <div class="filter-group">
                                <label>Time Range:</label>
                                <select id="topicTimeRange" class="select-input">
                                    <option value="day">Past 24 Hours</option>
                                    <option value="week" selected>Past Week</option>
                                    <option value="month">Past Month</option>
                                    <option value="year">Past Year</option>
                                    <option value="all">All Time</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Max Results:</label>
                                <select id="topicLimit" class="select-input">
                                    <option value="10">10 posts</option>
                                    <option value="15" selected>15 posts</option>
                                    <option value="25">25 posts</option>
                                    <option value="50">50 posts</option>
                                </select>
                            </div>
                        </div>
                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" id="topicSubredditFilter" onchange="toggleTopicSubredditInput()">
                                üéØ Search specific subreddits only
                            </label>
                            <div id="topicSubredditInputDiv" style="display: none; margin-top: 10px;">
                                <input
                                    type="text"
                                    id="topicSubreddits"
                                    placeholder="e.g., AskReddit, science, technology"
                                    class="url-input"
                                />
                                <p class="hint">Comma-separated list of subreddits</p>
                            </div>
                        </div>
                        <button class="analyze-btn" onclick="handleSearchByTopic()">
                            üîç Search Posts
                        </button>
                    </div>
                </div>

                <!-- Topic Search Results -->
                <div id="topicResults" style="display: none;">
                    <div class="results-header">
                        <h3 id="topicResultsTitle">Search Results</h3>
                        <div id="topicResultsSummary"></div>
                    </div>
                    <div id="topicPostsList"></div>
                    <div id="topicSelectedActions" style="display: none;">
                        <div class="selected-summary">
                            <span id="topicSelectedCount">0 posts selected</span>
                            <button class="analyze-btn" onclick="analyzeTopicSelectedPosts()">
                                üìä Analyze Selected Posts
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 3: Subreddit Analysis -->
            <div id="subredditTab" class="tab-content" style="display: none;">
                <div class="input-section">
                    <h2>Analyze Subreddit Top Posts</h2>
                    <div class="search-form">
                        <div class="input-group">
                            <input
                                type="text"
                                id="subredditName"
                                placeholder="Enter subreddit name (without r/)..."
                                class="url-input"
                            />
                        </div>
                        <div class="filter-row">
                            <div class="filter-group">
                                <label>Time Range:</label>
                                <select id="subredditTimeRange" class="select-input">
                                    <option value="day">Past 24 Hours</option>
                                    <option value="week" selected>Past Week</option>
                                    <option value="month">Past Month</option>
                                    <option value="year">Past Year</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Max Results:</label>
                                <select id="subredditLimit" class="select-input">
                                    <option value="10">10 posts</option>
                                    <option value="15" selected>15 posts</option>
                                    <option value="25">25 posts</option>
                                    <option value="50">50 posts</option>
                                </select>
                            </div>
                        </div>
                        <button class="analyze-btn" onclick="handleSearchSubreddit()">
                            üìä Get Top Posts
                        </button>
                    </div>
                </div>

                <!-- Subreddit Search Results -->
                <div id="subredditResults" style="display: none;">
                    <div class="results-header">
                        <h3 id="subredditResultsTitle">Top Posts</h3>
                        <div id="subredditResultsSummary"></div>
                    </div>
                    <div id="subredditPostsList"></div>
                    <div id="subredditSelectedActions" style="display: none;">
                        <div class="selected-summary">
                            <span id="subredditSelectedCount">0 posts selected</span>
                            <button class="analyze-btn" onclick="analyzeSubredditSelectedPosts()">
                                üìä Analyze Selected Posts
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Status Section -->
            <section id="statusSection" class="status-section" style="display: none;">
                <div class="status-card">
                    <div class="status-icon">‚è≥</div>
                    <div class="status-text" id="statusText">Initializing...</div>
                    <div class="status-progress">
                        <div class="progress-bar" id="progressBar" style="width: 0%"></div>
                    </div>
                </div>
            </section>

            <!-- Results Section -->
            <section id="resultsSection" class="results-section" style="display: none;">
                <!-- Extracted Data -->
                <div id="extractedDataCard" class="result-card" style="display: none;">
                    <div class="card-header">
                        <h2>üìä Extracted Comments</h2>
                        <div style="display: flex; gap: 10px;">
                            <button class="export-btn" onclick="exportToPDF()" style="background: #ed8936;">üìÑ Export PDF</button>
                            <button class="export-btn" onclick="copyToClipboard()" style="background: #9f7aea;">üìã Copy for AI</button>
                            <button class="export-btn" onclick="copyAsText()" style="background: #48bb78;">üìù Copy Text</button>
                            <button class="export-btn" onclick="exportData()">üíæ Export JSON</button>
                        </div>
                    </div>
                    <div id="extractedDataContent"></div>
                </div>

                <!-- AI Insights -->
                <div id="insightsCard" class="result-card" style="display: none;">
                    <div class="card-header">
                        <h2>ü§ñ AI-Powered Insights</h2>
                        <button class="export-btn" onclick="exportInsights()">üì• Export as PDF</button>
                    </div>
                    <div id="insightsContent"></div>
                </div>

                <!-- Multi-Post Results -->
                <div id="multiPostResults" style="display: none;"></div>
            </section>

            <!-- Error Section -->
            <section id="errorSection" class="error-section" style="display: none;">
                <div class="error-card">
                    <div class="error-icon">‚ö†Ô∏è</div>
                    <div class="error-title">Analysis Failed</div>
                    <div class="error-message" id="errorMessage"></div>
                    <button class="retry-btn" onclick="location.reload()">Try Again</button>
                </div>
            </section>
        </main>

        <footer>
            <p>Powered by Gemini AI ‚Ä¢ Node.js Backend ‚Ä¢ <a href="https://github.com/codewithjaidesai/reddit-analysis" target="_blank">GitHub</a></p>
        </footer>
    </div>

    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
