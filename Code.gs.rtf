{\rtf1\ansi\ansicpg1252\cocoartf2761
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Regular;}
{\colortbl;\red255\green255\blue255;\red77\green80\blue85;\red246\green247\blue249;\red46\green49\blue51;
\red20\green67\blue174;\red186\green6\blue115;\red24\green25\blue27;\red162\green0\blue16;\red18\green115\blue126;
\red97\green3\blue173;}
{\*\expandedcolortbl;;\cssrgb\c37255\c38824\c40784;\cssrgb\c97255\c97647\c98039;\cssrgb\c23529\c25098\c26275;
\cssrgb\c9412\c35294\c73725;\cssrgb\c78824\c15294\c52549;\cssrgb\c12549\c12941\c14118;\cssrgb\c70196\c7843\c7059;\cssrgb\c3529\c52157\c56863;
\cssrgb\c46275\c15294\c73333;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs26 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 // Reddit API Configuration\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 const\cf4 \strokec4  \cf6 \strokec6 REDDIT_CONFIG\cf4 \strokec4  = \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf7 \strokec7 clientId\cf4 \strokec4 : \cf8 \strokec8 'FSkASxBHOGaYVZLWpQO9TA'\cf4 \strokec4 ,\cb1 \
\cb3   \cf7 \strokec7 clientSecret\cf4 \strokec4 : \cf8 \strokec8 'AnNiJyAazf5-iW5s16ppCzXJbLNwEw'\cf4 \strokec4 ,\cb1 \
\cb3   \cf7 \strokec7 userAgent\cf4 \strokec4 : \cf8 \strokec8 'web:RedditAnalyzer:v1.0.0 (by /u/gamestopfan)'\cf4 \cb1 \strokec4 \
\cb3 \};\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Cache Reddit access token in Script Properties\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 getRedditAccessToken\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 scriptProperties\cf4 \strokec4  = \cf6 \strokec6 PropertiesService\cf4 \strokec4 .\cf7 \strokec7 getScriptProperties\cf4 \strokec4 ();\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 cachedToken\cf4 \strokec4  = \cf7 \strokec7 scriptProperties\cf4 \strokec4 .\cf7 \strokec7 getProperty\cf4 \strokec4 (\cf8 \strokec8 'reddit_token'\cf4 \strokec4 );\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 tokenExpiry\cf4 \strokec4  = \cf7 \strokec7 scriptProperties\cf4 \strokec4 .\cf7 \strokec7 getProperty\cf4 \strokec4 (\cf8 \strokec8 'reddit_token_expiry'\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Check if we have a valid cached token\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 cachedToken\cf4 \strokec4  && \cf7 \strokec7 tokenExpiry\cf4 \strokec4  && \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Date\cf4 \strokec4 () < \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Date\cf4 \strokec4 (\cf7 \strokec7 tokenExpiry\cf4 \strokec4 )) \{\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Using cached Reddit token'\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 cachedToken\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Fetching new Reddit token'\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Get new token using client credentials flow\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 auth\cf4 \strokec4  = \cf6 \strokec6 Utilities\cf4 \strokec4 .\cf7 \strokec7 base64Encode\cf4 \strokec4 (\cf8 \strokec8 `\cf4 \strokec4 $\{\cf6 \strokec6 REDDIT_CONFIG\cf4 \strokec4 .\cf7 \strokec7 clientId\cf4 \strokec4 \}\cf8 \strokec8 :\cf4 \strokec4 $\{\cf6 \strokec6 REDDIT_CONFIG\cf4 \strokec4 .\cf7 \strokec7 clientSecret\cf4 \strokec4 \}\cf8 \strokec8 `\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 options\cf4 \strokec4  = \{\cb1 \
\cb3     \cf7 \strokec7 method\cf4 \strokec4 : \cf8 \strokec8 'POST'\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 headers\cf4 \strokec4 : \{\cb1 \
\cb3       \cf8 \strokec8 'Authorization'\cf4 \strokec4 : \cf8 \strokec8 `Basic \cf4 \strokec4 $\{\cf7 \strokec7 auth\cf4 \strokec4 \}\cf8 \strokec8 `\cf4 \strokec4 ,\cb1 \
\cb3       \cf8 \strokec8 'Content-Type'\cf4 \strokec4 : \cf8 \strokec8 'application/x-www-form-urlencoded'\cf4 \strokec4 ,\cb1 \
\cb3       \cf8 \strokec8 'User-Agent'\cf4 \strokec4 : \cf6 \strokec6 REDDIT_CONFIG\cf4 \strokec4 .\cf7 \strokec7 userAgent\cf4 \cb1 \strokec4 \
\cb3     \},\cb1 \
\cb3     \cf7 \strokec7 payload\cf4 \strokec4 : \cf8 \strokec8 'grant_type=client_credentials'\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 muteHttpExceptions\cf4 \strokec4 : \cf5 \strokec5 true\cf4 \cb1 \strokec4 \
\cb3   \};\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 try\cf4 \strokec4  \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 response\cf4 \strokec4  = \cf6 \strokec6 UrlFetchApp\cf4 \strokec4 .\cf7 \strokec7 fetch\cf4 \strokec4 (\cf8 \strokec8 'https://www.reddit.com/api/v1/access_token'\cf4 \strokec4 , \cf7 \strokec7 options\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 data\cf4 \strokec4  = \cf6 \strokec6 JSON\cf4 \strokec4 .\cf7 \strokec7 parse\cf4 \strokec4 (\cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 getContentText\cf4 \strokec4 ());\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 access_token\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf2 \strokec2 // Cache token with expiry\cf4 \cb1 \strokec4 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 expiryDate\cf4 \strokec4  = \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Date\cf4 \strokec4 ();\cb1 \
\cb3       \cf7 \strokec7 expiryDate\cf4 \strokec4 .\cf7 \strokec7 setSeconds\cf4 \strokec4 (\cf7 \strokec7 expiryDate\cf4 \strokec4 .\cf7 \strokec7 getSeconds\cf4 \strokec4 () + (\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 expires_in\cf4 \strokec4  - \cf9 \strokec9 60\cf4 \strokec4 )); \cf2 \strokec2 // Expire 1 minute early\cf4 \cb1 \strokec4 \
\cb3       \cb1 \
\cb3       \cf7 \strokec7 scriptProperties\cf4 \strokec4 .\cf7 \strokec7 setProperty\cf4 \strokec4 (\cf8 \strokec8 'reddit_token'\cf4 \strokec4 , \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 access_token\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 scriptProperties\cf4 \strokec4 .\cf7 \strokec7 setProperty\cf4 \strokec4 (\cf8 \strokec8 'reddit_token_expiry'\cf4 \strokec4 , \cf7 \strokec7 expiryDate\cf4 \strokec4 .\cf7 \strokec7 toISOString\cf4 \strokec4 ());\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 access_token\cf4 \strokec4 ;\cb1 \
\cb3     \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3       \cf5 \strokec5 throw\cf4 \strokec4  \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Error\cf4 \strokec4 (\cf8 \strokec8 'Failed to get Reddit access token'\cf4 \strokec4 );\cb1 \
\cb3     \}\cb1 \
\cb3   \} \cf5 \strokec5 catch\cf4 \strokec4  (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf8 \strokec8 'Token fetch error:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 throw\cf4 \strokec4  \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Error\cf4 \strokec4 (\cf8 \strokec8 'Failed to authenticate with Reddit API'\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 doGet\cf4 \strokec4 (\cf7 \strokec7 e\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 output\cf4 \strokec4  = \cf6 \strokec6 ContentService\cf4 \strokec4 .\cf7 \strokec7 createTextOutput\cf4 \strokec4 ();\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 try\cf4 \strokec4  \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 url\cf4 \strokec4  = \cf7 \strokec7 e\cf4 \strokec4 .\cf7 \strokec7 parameter\cf4 \strokec4 .\cf7 \strokec7 url\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 mode\cf4 \strokec4  = \cf7 \strokec7 e\cf4 \strokec4 .\cf7 \strokec7 parameter\cf4 \strokec4 .\cf7 \strokec7 mode\cf4 \strokec4  || \cf8 \strokec8 'deep'\cf4 \strokec4 ; \cf2 \strokec2 // 'deep' for single post, 'overview' for subreddit\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 callback\cf4 \strokec4  = \cf7 \strokec7 e\cf4 \strokec4 .\cf7 \strokec7 parameter\cf4 \strokec4 .\cf7 \strokec7 callback\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Processing request for:'\cf4 \strokec4 , \cf7 \strokec7 url\cf4 \strokec4 , \cf8 \strokec8 'Mode:'\cf4 \strokec4 , \cf7 \strokec7 mode\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 processedData\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 mode\cf4 \strokec4  === \cf8 \strokec8 'overview'\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf2 \strokec2 // Subreddit overview mode\cf4 \cb1 \strokec4 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 redditData\cf4 \strokec4  = \cf7 \strokec7 fetchSubredditOverview\cf4 \strokec4 (\cf7 \strokec7 url\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 processedData\cf4 \strokec4  = \cf7 \strokec7 processSubredditOverview\cf4 \strokec4 (\cf7 \strokec7 redditData\cf4 \strokec4 , \cf7 \strokec7 url\cf4 \strokec4 );\cb1 \
\cb3     \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3       \cf2 \strokec2 // Deep dive mode for single post\cf4 \cb1 \strokec4 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 redditData\cf4 \strokec4  = \cf7 \strokec7 fetchAuthenticatedRedditData\cf4 \strokec4 (\cf7 \strokec7 url\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 processedData\cf4 \strokec4  = \cf7 \strokec7 processRealRedditData\cf4 \strokec4 (\cf7 \strokec7 redditData\cf4 \strokec4 );\cb1 \
\cb3     \}\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 responseData\cf4 \strokec4  = \{\cb1 \
\cb3       \cf7 \strokec7 success\cf4 \strokec4 : \cf5 \strokec5 true\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 message\cf4 \strokec4 : \cf8 \strokec8 "Real Reddit data fetched successfully!"\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 receivedUrl\cf4 \strokec4 : \cf7 \strokec7 url\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 mode\cf4 \strokec4 : \cf7 \strokec7 mode\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 timestamp\cf4 \strokec4 : \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Date\cf4 \strokec4 ().\cf7 \strokec7 toISOString\cf4 \strokec4 (),\cb1 \
\cb3       \cf7 \strokec7 data\cf4 \strokec4 : \cf7 \strokec7 processedData\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 dataSource\cf4 \strokec4 : \cf8 \strokec8 "Reddit OAuth API"\cf4 \cb1 \strokec4 \
\cb3     \};\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 callback\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \strokec7 output\cf4 \strokec4 .\cf7 \strokec7 setMimeType\cf4 \strokec4 (\cf6 \strokec6 ContentService\cf4 \strokec4 .\cf6 \strokec6 MimeType\cf4 \strokec4 .\cf6 \strokec6 JAVASCRIPT\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 output\cf4 \strokec4 .\cf7 \strokec7 setContent\cf4 \strokec4 (\cf7 \strokec7 callback\cf4 \strokec4  + \cf8 \strokec8 '('\cf4 \strokec4  + \cf6 \strokec6 JSON\cf4 \strokec4 .\cf7 \strokec7 stringify\cf4 \strokec4 (\cf7 \strokec7 responseData\cf4 \strokec4 ) + \cf8 \strokec8 ');'\cf4 \strokec4 );\cb1 \
\cb3     \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3       \cf7 \strokec7 output\cf4 \strokec4 .\cf7 \strokec7 setMimeType\cf4 \strokec4 (\cf6 \strokec6 ContentService\cf4 \strokec4 .\cf6 \strokec6 MimeType\cf4 \strokec4 .\cf6 \strokec6 JSON\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 output\cf4 \strokec4 .\cf7 \strokec7 setContent\cf4 \strokec4 (\cf6 \strokec6 JSON\cf4 \strokec4 .\cf7 \strokec7 stringify\cf4 \strokec4 (\cf7 \strokec7 responseData\cf4 \strokec4 ));\cb1 \
\cb3     \}\cb1 \
\cb3     \cb1 \
\cb3   \} \cf5 \strokec5 catch\cf4 \strokec4  (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf8 \strokec8 'Error:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 errorResponse\cf4 \strokec4  = \{\cb1 \
\cb3       \cf7 \strokec7 error\cf4 \strokec4 : \cf7 \strokec7 error\cf4 \strokec4 .\cf7 \strokec7 message\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 success\cf4 \strokec4 : \cf5 \strokec5 false\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 timestamp\cf4 \strokec4 : \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Date\cf4 \strokec4 ().\cf7 \strokec7 toISOString\cf4 \strokec4 (),\cb1 \
\cb3       \cf7 \strokec7 dataSource\cf4 \strokec4 : \cf8 \strokec8 "Error"\cf4 \cb1 \strokec4 \
\cb3     \};\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 e\cf4 \strokec4 .\cf7 \strokec7 parameter\cf4 \strokec4 .\cf7 \strokec7 callback\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \strokec7 output\cf4 \strokec4 .\cf7 \strokec7 setMimeType\cf4 \strokec4 (\cf6 \strokec6 ContentService\cf4 \strokec4 .\cf6 \strokec6 MimeType\cf4 \strokec4 .\cf6 \strokec6 JAVASCRIPT\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 output\cf4 \strokec4 .\cf7 \strokec7 setContent\cf4 \strokec4 (\cf7 \strokec7 e\cf4 \strokec4 .\cf7 \strokec7 parameter\cf4 \strokec4 .\cf7 \strokec7 callback\cf4 \strokec4  + \cf8 \strokec8 '('\cf4 \strokec4  + \cf6 \strokec6 JSON\cf4 \strokec4 .\cf7 \strokec7 stringify\cf4 \strokec4 (\cf7 \strokec7 errorResponse\cf4 \strokec4 ) + \cf8 \strokec8 ');'\cf4 \strokec4 );\cb1 \
\cb3     \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3       \cf7 \strokec7 output\cf4 \strokec4 .\cf7 \strokec7 setMimeType\cf4 \strokec4 (\cf6 \strokec6 ContentService\cf4 \strokec4 .\cf6 \strokec6 MimeType\cf4 \strokec4 .\cf6 \strokec6 JSON\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 output\cf4 \strokec4 .\cf7 \strokec7 setContent\cf4 \strokec4 (\cf6 \strokec6 JSON\cf4 \strokec4 .\cf7 \strokec7 stringify\cf4 \strokec4 (\cf7 \strokec7 errorResponse\cf4 \strokec4 ));\cb1 \
\cb3     \}\cb1 \
\cb3   \}\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Fetch subreddit overview (all posts, basic stats)\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 fetchSubredditOverview\cf4 \strokec4 (\cf7 \strokec7 inputUrl\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 accessToken\cf4 \strokec4  = \cf7 \strokec7 getRedditAccessToken\cf4 \strokec4 ();\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Extract subreddit name\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 subreddit\cf4 \strokec4  = \cf7 \strokec7 inputUrl\cf4 \strokec4 .\cf7 \strokec7 replace\cf4 \strokec4 (\cf10 \strokec10 /^r\\//\cf4 \strokec4 , \cf8 \strokec8 ''\cf4 \strokec4 ).\cf7 \strokec7 replace\cf4 \strokec4 (\cf10 \strokec10 /^\\/r\\//\cf4 \strokec4 , \cf8 \strokec8 ''\cf4 \strokec4 ).\cf7 \strokec7 replace\cf4 \strokec4 (\cf10 \strokec10 /\\/$/\cf4 \strokec4 , \cf8 \strokec8 ''\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Get posts from the last 24 hours (hot, new, and top)\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 endpoints\cf4 \strokec4  = [\cb1 \
\cb3     \cf8 \strokec8 `https://oauth.reddit.com/r/\cf4 \strokec4 $\{\cf7 \strokec7 subreddit\cf4 \strokec4 \}\cf8 \strokec8 /hot?limit=50&raw_json=1`\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 `https://oauth.reddit.com/r/\cf4 \strokec4 $\{\cf7 \strokec7 subreddit\cf4 \strokec4 \}\cf8 \strokec8 /new?limit=50&raw_json=1`\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 `https://oauth.reddit.com/r/\cf4 \strokec4 $\{\cf7 \strokec7 subreddit\cf4 \strokec4 \}\cf8 \strokec8 /top?t=day&limit=50&raw_json=1`\cf4 \cb1 \strokec4 \
\cb3   ];\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 allPosts\cf4 \strokec4  = [];\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 seenIds\cf4 \strokec4  = \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Set\cf4 \strokec4 ();\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 endpoints\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 apiUrl\cf4 \strokec4  => \{\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Fetching from:'\cf4 \strokec4 , \cf7 \strokec7 apiUrl\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 options\cf4 \strokec4  = \{\cb1 \
\cb3       \cf7 \strokec7 method\cf4 \strokec4 : \cf8 \strokec8 'GET'\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 headers\cf4 \strokec4 : \{\cb1 \
\cb3         \cf8 \strokec8 'Authorization'\cf4 \strokec4 : \cf8 \strokec8 `bearer \cf4 \strokec4 $\{\cf7 \strokec7 accessToken\cf4 \strokec4 \}\cf8 \strokec8 `\cf4 \strokec4 ,\cb1 \
\cb3         \cf8 \strokec8 'User-Agent'\cf4 \strokec4 : \cf6 \strokec6 REDDIT_CONFIG\cf4 \strokec4 .\cf7 \strokec7 userAgent\cf4 \strokec4 ,\cb1 \
\cb3         \cf8 \strokec8 'Accept'\cf4 \strokec4 : \cf8 \strokec8 'application/json'\cf4 \cb1 \strokec4 \
\cb3       \},\cb1 \
\cb3       \cf7 \strokec7 muteHttpExceptions\cf4 \strokec4 : \cf5 \strokec5 true\cf4 \cb1 \strokec4 \
\cb3     \};\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4  \{\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 response\cf4 \strokec4  = \cf6 \strokec6 UrlFetchApp\cf4 \strokec4 .\cf7 \strokec7 fetch\cf4 \strokec4 (\cf7 \strokec7 apiUrl\cf4 \strokec4 , \cf7 \strokec7 options\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 getResponseCode\cf4 \strokec4 () === \cf9 \strokec9 200\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 data\cf4 \strokec4  = \cf6 \strokec6 JSON\cf4 \strokec4 .\cf7 \strokec7 parse\cf4 \strokec4 (\cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 getContentText\cf4 \strokec4 ());\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 child\cf4 \strokec4  => \{\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  (!\cf7 \strokec7 seenIds\cf4 \strokec4 .\cf7 \strokec7 has\cf4 \strokec4 (\cf7 \strokec7 child\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 id\cf4 \strokec4 ) && !\cf7 \strokec7 child\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 stickied\cf4 \strokec4 ) \{\cb1 \
\cb3               \cf7 \strokec7 seenIds\cf4 \strokec4 .\cf7 \strokec7 add\cf4 \strokec4 (\cf7 \strokec7 child\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 id\cf4 \strokec4 );\cb1 \
\cb3               \cf7 \strokec7 allPosts\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\cf7 \strokec7 child\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 );\cb1 \
\cb3             \}\cb1 \
\cb3           \});\cb1 \
\cb3         \}\cb1 \
\cb3       \}\cb1 \
\cb3     \} \cf5 \strokec5 catch\cf4 \strokec4  (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf8 \strokec8 'Error fetching from endpoint:'\cf4 \strokec4 , \cf7 \strokec7 apiUrl\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 allPosts\cf4 \strokec4 ;\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Process subreddit overview data\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 processSubredditOverview\cf4 \strokec4 (\cf7 \strokec7 posts\cf4 \strokec4 , \cf7 \strokec7 subreddit\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 now\cf4 \strokec4  = \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Date\cf4 \strokec4 ();\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 yesterday\cf4 \strokec4  = \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Date\cf4 \strokec4 (\cf7 \strokec7 now\cf4 \strokec4 .\cf7 \strokec7 getTime\cf4 \strokec4 () - \cf9 \strokec9 24\cf4 \strokec4  * \cf9 \strokec9 60\cf4 \strokec4  * \cf9 \strokec9 60\cf4 \strokec4  * \cf9 \strokec9 1000\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Filter posts from last 24 hours\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 recentPosts\cf4 \strokec4  = \cf7 \strokec7 posts\cf4 \strokec4 .\cf7 \strokec7 filter\cf4 \strokec4 (\cf7 \strokec7 post\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 postTime\cf4 \strokec4  = \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Date\cf4 \strokec4 (\cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 created_utc\cf4 \strokec4  * \cf9 \strokec9 1000\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 postTime\cf4 \strokec4  >= \cf7 \strokec7 yesterday\cf4 \strokec4 ;\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Sort by score\cf4 \cb1 \strokec4 \
\cb3   \cf7 \strokec7 recentPosts\cf4 \strokec4 .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  - \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Calculate overview stats\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 totalScore\cf4 \strokec4  = \cf7 \strokec7 recentPosts\cf4 \strokec4 .\cf7 \strokec7 reduce\cf4 \strokec4 ((\cf7 \strokec7 sum\cf4 \strokec4 , \cf7 \strokec7 post\cf4 \strokec4 ) => \cf7 \strokec7 sum\cf4 \strokec4  + \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 , \cf9 \strokec9 0\cf4 \strokec4 );\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 totalComments\cf4 \strokec4  = \cf7 \strokec7 recentPosts\cf4 \strokec4 .\cf7 \strokec7 reduce\cf4 \strokec4 ((\cf7 \strokec7 sum\cf4 \strokec4 , \cf7 \strokec7 post\cf4 \strokec4 ) => \cf7 \strokec7 sum\cf4 \strokec4  + \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 num_comments\cf4 \strokec4 , \cf9 \strokec9 0\cf4 \strokec4 );\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 avgScore\cf4 \strokec4  = \cf7 \strokec7 recentPosts\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \strokec4  ? \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 round\cf4 \strokec4 (\cf7 \strokec7 totalScore\cf4 \strokec4  / \cf7 \strokec7 recentPosts\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 ) : \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 avgComments\cf4 \strokec4  = \cf7 \strokec7 recentPosts\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \strokec4  ? \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 round\cf4 \strokec4 (\cf7 \strokec7 totalComments\cf4 \strokec4  / \cf7 \strokec7 recentPosts\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 ) : \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Find posts with high engagement relative to average\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 highEngagementPosts\cf4 \strokec4  = \cf7 \strokec7 recentPosts\cf4 \strokec4 .\cf7 \strokec7 filter\cf4 \strokec4 (\cf7 \strokec7 post\cf4 \strokec4  => \cb1 \
\cb3     \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  > \cf7 \strokec7 avgScore\cf4 \strokec4  * \cf9 \strokec9 2\cf4 \strokec4  || \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 num_comments\cf4 \strokec4  > \cf7 \strokec7 avgComments\cf4 \strokec4  * \cf9 \strokec9 2\cf4 \cb1 \strokec4 \
\cb3   );\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Format posts for display\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 formattedPosts\cf4 \strokec4  = \cf7 \strokec7 recentPosts\cf4 \strokec4 .\cf7 \strokec7 map\cf4 \strokec4 (\cf7 \strokec7 post\cf4 \strokec4  => (\{\cb1 \
\cb3     \cf7 \strokec7 id\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 id\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 title\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 title\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 num_comments\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 num_comments\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 created_utc\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 created_utc\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 url\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 url\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 is_self\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 is_self\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 upvote_ratio\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 upvote_ratio\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 awards\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 total_awards_received\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 engagement_score\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  + (\cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 num_comments\cf4 \strokec4  * \cf9 \strokec9 10\cf4 \strokec4 ), \cf2 \strokec2 // Custom engagement metric\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 is_high_engagement\cf4 \strokec4 : \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  > \cf7 \strokec7 avgScore\cf4 \strokec4  * \cf9 \strokec9 2\cf4 \strokec4  || \cf7 \strokec7 post\cf4 \strokec4 .\cf7 \strokec7 num_comments\cf4 \strokec4  > \cf7 \strokec7 avgComments\cf4 \strokec4  * \cf9 \strokec9 2\cf4 \cb1 \strokec4 \
\cb3   \}));\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \{\cb1 \
\cb3     \cf7 \strokec7 subreddit\cf4 \strokec4 : \cf7 \strokec7 subreddit\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 timeframe\cf4 \strokec4 : \cf8 \strokec8 '24 hours'\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 posts\cf4 \strokec4 : \cf7 \strokec7 formattedPosts\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 stats\cf4 \strokec4 : \{\cb1 \
\cb3       \cf7 \strokec7 totalPosts\cf4 \strokec4 : \cf7 \strokec7 recentPosts\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 totalScore\cf4 \strokec4 : \cf7 \strokec7 totalScore\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 totalComments\cf4 \strokec4 : \cf7 \strokec7 totalComments\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 avgScore\cf4 \strokec4 : \cf7 \strokec7 avgScore\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 avgComments\cf4 \strokec4 : \cf7 \strokec7 avgComments\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 highEngagementCount\cf4 \strokec4 : \cf7 \strokec7 highEngagementPosts\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 topPost\cf4 \strokec4 : \cf7 \strokec7 recentPosts\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ] ? \{\cb1 \
\cb3         \cf7 \strokec7 title\cf4 \strokec4 : \cf7 \strokec7 recentPosts\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ].\cf7 \strokec7 title\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 recentPosts\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ].\cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 comments\cf4 \strokec4 : \cf7 \strokec7 recentPosts\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ].\cf7 \strokec7 num_comments\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 recentPosts\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ].\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3       \} : \cf5 \strokec5 null\cf4 \cb1 \strokec4 \
\cb3     \}\cb1 \
\cb3   \};\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 fetchAuthenticatedRedditData\cf4 \strokec4 (\cf7 \strokec7 inputUrl\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 accessToken\cf4 \strokec4  = \cf7 \strokec7 getRedditAccessToken\cf4 \strokec4 ();\cb1 \
\cb3   \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 apiUrl\cf4 \strokec4 ;\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 inputUrl\cf4 \strokec4 .\cf7 \strokec7 includes\cf4 \strokec4 (\cf8 \strokec8 'reddit.com'\cf4 \strokec4 )) \{\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 inputUrl\cf4 \strokec4 .\cf7 \strokec7 includes\cf4 \strokec4 (\cf8 \strokec8 '/comments/'\cf4 \strokec4 )) \{\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 postMatch\cf4 \strokec4  = \cf7 \strokec7 inputUrl\cf4 \strokec4 .\cf7 \strokec7 match\cf4 \strokec4 (\cf10 \strokec10 /comments\\/([a-zA-Z0-9]+)/\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 postMatch\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf2 \strokec2 // Increased limits for deep dive\cf4 \cb1 \strokec4 \
\cb3         \cf7 \strokec7 apiUrl\cf4 \strokec4  = \cf8 \strokec8 `https://oauth.reddit.com/comments/\cf4 \strokec4 $\{\cf7 \strokec7 postMatch\cf4 \strokec4 [\cf9 \strokec9 1\cf4 \strokec4 ]\}\cf8 \strokec8 ?limit=200&depth=5&sort=top&raw_json=1`\cf4 \strokec4 ;\cb1 \
\cb3       \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3         \cf5 \strokec5 throw\cf4 \strokec4  \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Error\cf4 \strokec4 (\cf8 \strokec8 'Invalid Reddit post URL format'\cf4 \strokec4 );\cb1 \
\cb3       \}\cb1 \
\cb3     \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3       \cf5 \strokec5 throw\cf4 \strokec4  \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Error\cf4 \strokec4 (\cf8 \strokec8 'Please provide a direct post URL or subreddit name'\cf4 \strokec4 );\cb1 \
\cb3     \}\cb1 \
\cb3   \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3     \cf2 \strokec2 // For backward compatibility - treat as subreddit overview\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 fetchSubredditOverview\cf4 \strokec4 (\cf7 \strokec7 inputUrl\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Fetching from:'\cf4 \strokec4 , \cf7 \strokec7 apiUrl\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 options\cf4 \strokec4  = \{\cb1 \
\cb3     \cf7 \strokec7 method\cf4 \strokec4 : \cf8 \strokec8 'GET'\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 headers\cf4 \strokec4 : \{\cb1 \
\cb3       \cf8 \strokec8 'Authorization'\cf4 \strokec4 : \cf8 \strokec8 `bearer \cf4 \strokec4 $\{\cf7 \strokec7 accessToken\cf4 \strokec4 \}\cf8 \strokec8 `\cf4 \strokec4 ,\cb1 \
\cb3       \cf8 \strokec8 'User-Agent'\cf4 \strokec4 : \cf6 \strokec6 REDDIT_CONFIG\cf4 \strokec4 .\cf7 \strokec7 userAgent\cf4 \strokec4 ,\cb1 \
\cb3       \cf8 \strokec8 'Accept'\cf4 \strokec4 : \cf8 \strokec8 'application/json'\cf4 \cb1 \strokec4 \
\cb3     \},\cb1 \
\cb3     \cf7 \strokec7 muteHttpExceptions\cf4 \strokec4 : \cf5 \strokec5 true\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 followRedirects\cf4 \strokec4 : \cf5 \strokec5 true\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 validateHttpsCertificates\cf4 \strokec4 : \cf5 \strokec5 false\cf4 \cb1 \strokec4 \
\cb3   \};\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 try\cf4 \strokec4  \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 startTime\cf4 \strokec4  = \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Date\cf4 \strokec4 ().\cf7 \strokec7 getTime\cf4 \strokec4 ();\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 response\cf4 \strokec4  = \cf6 \strokec6 UrlFetchApp\cf4 \strokec4 .\cf7 \strokec7 fetch\cf4 \strokec4 (\cf7 \strokec7 apiUrl\cf4 \strokec4 , \cf7 \strokec7 options\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 endTime\cf4 \strokec4  = \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Date\cf4 \strokec4 ().\cf7 \strokec7 getTime\cf4 \strokec4 ();\cb1 \
\cb3     \cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 `Fetch took \cf4 \strokec4 $\{\cf7 \strokec7 endTime\cf4 \strokec4  - \cf7 \strokec7 startTime\cf4 \strokec4 \}\cf8 \strokec8 ms`\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 responseCode\cf4 \strokec4  = \cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 getResponseCode\cf4 \strokec4 ();\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 responseText\cf4 \strokec4  = \cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 getContentText\cf4 \strokec4 ();\cb1 \
\cb3     \cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 `Response code: \cf4 \strokec4 $\{\cf7 \strokec7 responseCode\cf4 \strokec4 \}\cf8 \strokec8 , size: \cf4 \strokec4 $\{\cf7 \strokec7 responseText\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 \}\cf8 \strokec8  bytes`\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 responseCode\cf4 \strokec4  === \cf9 \strokec9 200\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 data\cf4 \strokec4  = \cf6 \strokec6 JSON\cf4 \strokec4 .\cf7 \strokec7 parse\cf4 \strokec4 (\cf7 \strokec7 responseText\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Successfully got Reddit data'\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 data\cf4 \strokec4 ;\cb1 \
\cb3     \} \cf5 \strokec5 else\cf4 \strokec4  \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 responseCode\cf4 \strokec4  === \cf9 \strokec9 401\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf6 \strokec6 PropertiesService\cf4 \strokec4 .\cf7 \strokec7 getScriptProperties\cf4 \strokec4 ().\cf7 \strokec7 deleteProperty\cf4 \strokec4 (\cf8 \strokec8 'reddit_token'\cf4 \strokec4 );\cb1 \
\cb3       \cf6 \strokec6 PropertiesService\cf4 \strokec4 .\cf7 \strokec7 getScriptProperties\cf4 \strokec4 ().\cf7 \strokec7 deleteProperty\cf4 \strokec4 (\cf8 \strokec8 'reddit_token_expiry'\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 throw\cf4 \strokec4  \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Error\cf4 \strokec4 (\cf8 \strokec8 'Authentication failed - token expired'\cf4 \strokec4 );\cb1 \
\cb3     \} \cf5 \strokec5 else\cf4 \strokec4  \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 responseCode\cf4 \strokec4  === \cf9 \strokec9 429\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 throw\cf4 \strokec4  \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Error\cf4 \strokec4 (\cf8 \strokec8 'Reddit rate limit - please wait 60 seconds'\cf4 \strokec4 );\cb1 \
\cb3     \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3       \cf5 \strokec5 throw\cf4 \strokec4  \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Error\cf4 \strokec4 (\cf8 \strokec8 `Reddit API error \cf4 \strokec4 $\{\cf7 \strokec7 responseCode\cf4 \strokec4 \}\cf8 \strokec8 `\cf4 \strokec4 );\cb1 \
\cb3     \}\cb1 \
\cb3   \} \cf5 \strokec5 catch\cf4 \strokec4  (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf8 \strokec8 'Fetch error:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 throw\cf4 \strokec4  \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Error\cf4 \strokec4 (\cf8 \strokec8 `Failed to fetch Reddit data: \cf4 \strokec4 $\{\cf7 \strokec7 error\cf4 \strokec4 .\cf7 \strokec7 message\cf4 \strokec4 \}\cf8 \strokec8 `\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 processRealRedditData\cf4 \strokec4 (\cf7 \strokec7 redditData\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 posts\cf4 \strokec4  = [];\cb1 \
\cb3   \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 comments\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Processing Reddit data structure...'\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf6 \strokec6 Array\cf4 \strokec4 .\cf7 \strokec7 isArray\cf4 \strokec4 (\cf7 \strokec7 redditData\cf4 \strokec4 ) && \cf7 \strokec7 redditData\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  >= \cf9 \strokec9 1\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf2 \strokec2 // Post data (always in first array element)\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 redditData\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ] && \cf7 \strokec7 redditData\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ].\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 redditData\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ].\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 postData\cf4 \strokec4  = \cf7 \strokec7 redditData\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ].\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ].\cf7 \strokec7 data\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 posts\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\cf7 \strokec7 postData\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Found post:'\cf4 \strokec4 , \cf7 \strokec7 postData\cf4 \strokec4 .\cf7 \strokec7 title\cf4 \strokec4 );\cb1 \
\cb3     \}\cb1 \
\cb3     \cb1 \
\cb3     \cf2 \strokec2 // Comments data (in second array element if it exists)\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 redditData\cf4 \strokec4 [\cf9 \strokec9 1\cf4 \strokec4 ] && \cf7 \strokec7 redditData\cf4 \strokec4 [\cf9 \strokec9 1\cf4 \strokec4 ].\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 redditData\cf4 \strokec4 [\cf9 \strokec9 1\cf4 \strokec4 ].\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 rawComments\cf4 \strokec4  = \cf7 \strokec7 redditData\cf4 \strokec4 [\cf9 \strokec9 1\cf4 \strokec4 ].\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 `Found \cf4 \strokec4 $\{\cf7 \strokec7 rawComments\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 \}\cf8 \strokec8  top-level comment objects`\cf4 \strokec4 );\cb1 \
\cb3       \cb1 \
\cb3       \cf2 \strokec2 // Process comments recursively to get nested replies\cf4 \cb1 \strokec4 \
\cb3       \cf7 \strokec7 comments\cf4 \strokec4  = \cf7 \strokec7 extractAllComments\cf4 \strokec4 (\cf7 \strokec7 rawComments\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 `Extracted \cf4 \strokec4 $\{\cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 \}\cf8 \strokec8  total comments including replies`\cf4 \strokec4 );\cb1 \
\cb3     \}\cb1 \
\cb3   \} \cf5 \strokec5 else\cf4 \strokec4  \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 redditData\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 redditData\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf2 \strokec2 // Subreddit listing - shouldn't happen in deep dive mode\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 throw\cf4 \strokec4  \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Error\cf4 \strokec4 (\cf8 \strokec8 'Got subreddit data instead of post data'\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Filter out deleted/removed comments\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 validComments\cf4 \strokec4  = \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 filter\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \cb1 \
\cb3     \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  && \cb1 \
\cb3     \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  !== \cf8 \strokec8 '[deleted]'\cf4 \strokec4  && \cb1 \
\cb3     \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  !== \cf8 \strokec8 '[removed]'\cf4 \strokec4  &&\cb1 \
\cb3     \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4  &&\cb1 \
\cb3     \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4  !== \cf8 \strokec8 '[deleted]'\cf4 \strokec4  &&\cb1 \
\cb3     \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 trim\cf4 \strokec4 ().\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 10\cf4 \cb1 \strokec4 \
\cb3   );\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 `\cf4 \strokec4 $\{\cf7 \strokec7 validComments\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 \}\cf8 \strokec8  valid comments after filtering`\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Sort comments by score (highest first)\cf4 \cb1 \strokec4 \
\cb3   \cf7 \strokec7 validComments\cf4 \strokec4 .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => (\cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ) - (\cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ));\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Extract enhanced insights including new features\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 insights\cf4 \strokec4  = \cf7 \strokec7 extractEnhancedInsights\cf4 \strokec4 (\cf7 \strokec7 posts\cf4 \strokec4 , \cf7 \strokec7 validComments\cf4 \strokec4 );\cb1 \
\cb3   \cf2 \strokec2 // Add simplified insights\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 try\cf4 \strokec4  \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 simplifiedInsights\cf4 \strokec4  = \cf7 \strokec7 extractWhatMatters\cf4 \strokec4 (\cf7 \strokec7 posts\cf4 \strokec4 , \cf7 \strokec7 validComments\cf4 \strokec4 );\cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 simplifiedInsights\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf2 \strokec2 // Merge simplified insights with existing ones\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 consensus\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 consensus\cf4 \strokec4  || [];\cb1 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 problems\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 problems\cf4 \strokec4  || [];\cb1 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 solutions\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 solutions\cf4 \strokec4  || [];\cb1 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 discussions\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 discussions\cf4 \strokec4  || [];\cb1 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 hiddenGems\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 hiddenGems\cf4 \strokec4  || [];\cb1 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 patterns\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 patterns\cf4 \strokec4  || [];\cb1 \
\cb3   \}\cb1 \
\cb3 \} \cf5 \strokec5 catch\cf4 \strokec4  (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3   \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf8 \strokec8 'Simplified extraction error:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3   \cf2 \strokec2 // Continue with existing insights if simplified fails\cf4 \cb1 \strokec4 \
\cb3 \}\cb1 \
\cb3   \cf2 \strokec2 // Extract special comment categories\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 postScore\cf4 \strokec4  = \cf7 \strokec7 posts\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ] ? \cf7 \strokec7 posts\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ].\cf7 \strokec7 score\cf4 \strokec4  : \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 specialComments\cf4 \strokec4  = \cf7 \strokec7 extractSpecialComments\cf4 \strokec4 (\cf7 \strokec7 validComments\cf4 \strokec4 , \cf7 \strokec7 postScore\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \{\cb1 \
\cb3     \cf7 \strokec7 posts\cf4 \strokec4 : \cf7 \strokec7 posts\cf4 \strokec4 .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 15\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 comments\cf4 \strokec4 : \cf7 \strokec7 validComments\cf4 \strokec4 .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 50\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 : \cf7 \strokec7 insights\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 specialComments\cf4 \strokec4 : \cf7 \strokec7 specialComments\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 stats\cf4 \strokec4 : \{\cb1 \
\cb3       \cf7 \strokec7 totalPosts\cf4 \strokec4 : \cf7 \strokec7 posts\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 totalComments\cf4 \strokec4 : \cf7 \strokec7 validComments\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 totalScore\cf4 \strokec4 : \cf7 \strokec7 validComments\cf4 \strokec4 .\cf7 \strokec7 reduce\cf4 \strokec4 ((\cf7 \strokec7 sum\cf4 \strokec4 , \cf7 \strokec7 c\cf4 \strokec4 ) => \cf7 \strokec7 sum\cf4 \strokec4  + (\cf7 \strokec7 c\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ), \cf9 \strokec9 0\cf4 \strokec4 ),\cb1 \
\cb3       \cf7 \strokec7 averageScore\cf4 \strokec4 : \cf7 \strokec7 validComments\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \strokec4  ? \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 round\cf4 \strokec4 (\cf7 \strokec7 validComments\cf4 \strokec4 .\cf7 \strokec7 reduce\cf4 \strokec4 ((\cf7 \strokec7 sum\cf4 \strokec4 , \cf7 \strokec7 c\cf4 \strokec4 ) => \cf7 \strokec7 sum\cf4 \strokec4  + (\cf7 \strokec7 c\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ), \cf9 \strokec9 0\cf4 \strokec4 ) / \cf7 \strokec7 validComments\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 ) : \cf9 \strokec9 0\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 topScore\cf4 \strokec4 : \cf7 \strokec7 validComments\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \strokec4  ? \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 max\cf4 \strokec4 (...\cf7 \strokec7 validComments\cf4 \strokec4 .\cf7 \strokec7 map\cf4 \strokec4 (\cf7 \strokec7 c\cf4 \strokec4  => \cf7 \strokec7 c\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 )) : \cf9 \strokec9 0\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 postScore\cf4 \strokec4 : \cf7 \strokec7 postScore\cf4 \cb1 \strokec4 \
\cb3     \}\cb1 \
\cb3   \};\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Extract special categories of comments\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractSpecialComments\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 , \cf7 \strokec7 postScore\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 tenPercentThreshold\cf4 \strokec4  = \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 round\cf4 \strokec4 (\cf7 \strokec7 postScore\cf4 \strokec4  * \cf9 \strokec9 0.1\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Comments with awards\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 awardedComments\cf4 \strokec4  = \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 filter\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \cb1 \
\cb3     \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 total_awards_received\cf4 \strokec4  && \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 total_awards_received\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \cb1 \strokec4 \
\cb3   ).\cf7 \strokec7 map\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => (\{\cb1 \
\cb3     \cf7 \strokec7 body\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 500\cf4 \strokec4 ) + (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 500\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 awards\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 total_awards_received\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 depth\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 depth\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \cb1 \strokec4 \
\cb3   \}));\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // High-ratio comments (10% of post score)\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 highRatioComments\cf4 \strokec4  = \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 filter\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \cb1 \
\cb3     \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  >= \cf7 \strokec7 tenPercentThreshold\cf4 \strokec4  && \cf7 \strokec7 tenPercentThreshold\cf4 \strokec4  > \cf9 \strokec9 100\cf4 \cb1 \strokec4 \
\cb3   ).\cf7 \strokec7 map\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => (\{\cb1 \
\cb3     \cf7 \strokec7 body\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 500\cf4 \strokec4 ) + (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 500\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 scoreRatio\cf4 \strokec4 : \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 round\cf4 \strokec4 ((\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  / \cf7 \strokec7 postScore\cf4 \strokec4 ) * \cf9 \strokec9 100\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 depth\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 depth\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \cb1 \strokec4 \
\cb3   \}));\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Comments with high reply activity\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 highReplyComments\cf4 \strokec4  = [];\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 controversialComments\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf2 \strokec2 // Count direct replies\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 replyCount\cf4 \strokec4  = \cf7 \strokec7 countReplies\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf2 \strokec2 // High reply activity (20+ replies in thread)\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 replyCount\cf4 \strokec4  > \cf9 \strokec9 20\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \strokec7 highReplyComments\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3         \cf7 \strokec7 body\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 500\cf4 \strokec4 ) + (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 500\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3         \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 replyCount\cf4 \strokec4 : \cf7 \strokec7 replyCount\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 depth\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 depth\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \cb1 \strokec4 \
\cb3       \});\cb1 \
\cb3     \}\cb1 \
\cb3     \cb1 \
\cb3     \cf2 \strokec2 // Controversial (high activity but mixed reception)\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 controversyScore\cf4 \strokec4  = \cf7 \strokec7 calculateControversy\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4 , \cf7 \strokec7 replyCount\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 controversyScore\cf4 \strokec4  > \cf9 \strokec9 0.5\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \strokec7 controversialComments\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3         \cf7 \strokec7 body\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 500\cf4 \strokec4 ) + (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 500\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3         \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 controversyScore\cf4 \strokec4 : \cf7 \strokec7 controversyScore\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 replyCount\cf4 \strokec4 : \cf7 \strokec7 replyCount\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 depth\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 depth\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \cb1 \strokec4 \
\cb3       \});\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \{\cb1 \
\cb3     \cf7 \strokec7 awarded\cf4 \strokec4 : \cf7 \strokec7 awardedComments\cf4 \strokec4 .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 highRatio\cf4 \strokec4 : \cf7 \strokec7 highRatioComments\cf4 \strokec4 .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 highReply\cf4 \strokec4 : \cf7 \strokec7 highReplyComments\cf4 \strokec4 .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 controversial\cf4 \strokec4 : \cf7 \strokec7 controversialComments\cf4 \strokec4 .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 )\cb1 \
\cb3   \};\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Count total replies in a comment thread\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 countReplies\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 count\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4  && \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 reply\cf4 \strokec4  => \{\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 reply\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 reply\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 count\cf4 \strokec4 ++;\cb1 \
\cb3         \cf7 \strokec7 count\cf4 \strokec4  += \cf7 \strokec7 countReplies\cf4 \strokec4 (\cf7 \strokec7 reply\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 );\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 count\cf4 \strokec4 ;\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Calculate controversy score\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 calculateControversy\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4 , \cf7 \strokec7 replyCount\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf2 \strokec2 // Factors: high replies, moderate score, high engagement\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 score\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 hasControversialFlag\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 controversiality\cf4 \strokec4  === \cf9 \strokec9 1\cf4 \strokec4 ;\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Calculate based on reply-to-score ratio and other factors\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 controversyScore\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 replyCount\cf4 \strokec4  > \cf9 \strokec9 10\cf4 \strokec4  && \cf7 \strokec7 score\cf4 \strokec4  < \cf9 \strokec9 100\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 controversyScore\cf4 \strokec4  += \cf9 \strokec9 0.3\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 replyCount\cf4 \strokec4  > \cf9 \strokec9 20\cf4 \strokec4  && \cf7 \strokec7 score\cf4 \strokec4  < \cf9 \strokec9 500\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 controversyScore\cf4 \strokec4  += \cf9 \strokec9 0.3\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 hasControversialFlag\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 controversyScore\cf4 \strokec4  += \cf9 \strokec9 0.4\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // High reply-to-score ratio indicates debate\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 replyCount\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \strokec4  && \cf7 \strokec7 score\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 ratio\cf4 \strokec4  = \cf7 \strokec7 replyCount\cf4 \strokec4  / \cf7 \strokec7 score\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 ratio\cf4 \strokec4  > \cf9 \strokec9 0.5\cf4 \strokec4 ) \cf7 \strokec7 controversyScore\cf4 \strokec4  += \cf9 \strokec9 0.3\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 min\cf4 \strokec4 (\cf7 \strokec7 controversyScore\cf4 \strokec4 , \cf9 \strokec9 1\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractAllComments\cf4 \strokec4 (\cf7 \strokec7 commentObjects\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 allComments\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 processComment\cf4 \strokec4 (\cf7 \strokec7 commentObj\cf4 \strokec4 , \cf7 \strokec7 depth\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 commentObj\cf4 \strokec4  && \cf7 \strokec7 commentObj\cf4 \strokec4 .\cf7 \strokec7 kind\cf4 \strokec4  !== \cf8 \strokec8 'more'\cf4 \strokec4  && \cf7 \strokec7 commentObj\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 commentObj\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 comment\cf4 \strokec4  = \cf7 \strokec7 commentObj\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 depth\cf4 \strokec4  = \cf7 \strokec7 depth\cf4 \strokec4 ; \cf2 \strokec2 // Add depth for context\cf4 \cb1 \strokec4 \
\cb3       \cf7 \strokec7 allComments\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4 );\cb1 \
\cb3       \cb1 \
\cb3       \cf2 \strokec2 // Process replies recursively\cf4 \cb1 \strokec4 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4  && \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 reply\cf4 \strokec4  => \{\cb1 \
\cb3           \cf7 \strokec7 processComment\cf4 \strokec4 (\cf7 \strokec7 reply\cf4 \strokec4 , \cf7 \strokec7 depth\cf4 \strokec4  + \cf9 \strokec9 1\cf4 \strokec4 );\cb1 \
\cb3         \});\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 commentObjects\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 commentObj\cf4 \strokec4  => \{\cb1 \
\cb3     \cf7 \strokec7 processComment\cf4 \strokec4 (\cf7 \strokec7 commentObj\cf4 \strokec4 , \cf9 \strokec9 0\cf4 \strokec4 );\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 allComments\cf4 \strokec4 ;\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractEnhancedInsights\cf4 \strokec4 (\cf7 \strokec7 posts\cf4 \strokec4 , \cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 allText\cf4 \strokec4  = [\cb1 \
\cb3     ...\cf7 \strokec7 posts\cf4 \strokec4 .\cf7 \strokec7 map\cf4 \strokec4 (\cf7 \strokec7 p\cf4 \strokec4  => (\cf7 \strokec7 p\cf4 \strokec4 .\cf7 \strokec7 title\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ) + \cf8 \strokec8 ' '\cf4 \strokec4  + (\cf7 \strokec7 p\cf4 \strokec4 .\cf7 \strokec7 selftext\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 )),\cb1 \
\cb3     ...\cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 map\cf4 \strokec4 (\cf7 \strokec7 c\cf4 \strokec4  => \cf7 \strokec7 c\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 )\cb1 \
\cb3   ].\cf7 \strokec7 join\cf4 \strokec4 (\cf8 \strokec8 ' '\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \{\cb1 \
\cb3     \cf2 \strokec2 // Keep existing basic insights\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 moneyMentions\cf4 \strokec4 : \cf7 \strokec7 extractMoneyMentions\cf4 \strokec4 (\cf7 \strokec7 allText\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 links\cf4 \strokec4 : \cf7 \strokec7 extractLinksWithContext\cf4 \strokec4 (\cf7 \strokec7 posts\cf4 \strokec4 , \cf7 \strokec7 comments\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 sentiment\cf4 \strokec4 : \cf7 \strokec7 analyzeSentiment\cf4 \strokec4 (\cf7 \strokec7 allText\cf4 \strokec4 ),\cb1 \
\cb3     \cb1 \
\cb3     \cf2 \strokec2 // Enhanced insights\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 contentGoldmines\cf4 \strokec4 : \cf7 \strokec7 extractContentGoldmines\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 entrepreneurialOpportunities\cf4 \strokec4 : \cf7 \strokec7 extractEntrepreneurialOpportunities\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 funnyMoments\cf4 \strokec4 : \cf7 \strokec7 extractFunnyMoments\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 deepRealizations\cf4 \strokec4 : \cf7 \strokec7 extractDeepRealizations\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 trendingThemes\cf4 \strokec4 : \cf7 \strokec7 extractExpandedTrendingThemes\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ), \cf2 \strokec2 // Enhanced version\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 expertInsights\cf4 \strokec4 : \cf7 \strokec7 extractExpertInsights\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 )\cb1 \
\cb3   \};\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Enhanced trending themes with more context\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractExpandedTrendingThemes\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 themeData\cf4 \strokec4  = \{\};\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Expanded theme keywords\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 themeKeywords\cf4 \strokec4  = \{\cb1 \
\cb3     \cf8 \strokec8 'AI/Technology'\cf4 \strokec4 : \{\cb1 \
\cb3       \cf7 \strokec7 keywords\cf4 \strokec4 : [\cf8 \strokec8 'AI'\cf4 \strokec4 , \cf8 \strokec8 'artificial intelligence'\cf4 \strokec4 , \cf8 \strokec8 'machine learning'\cf4 \strokec4 , \cf8 \strokec8 'automation'\cf4 \strokec4 , \cf8 \strokec8 'robot'\cf4 \strokec4 , \cf8 \strokec8 'algorithm'\cf4 \strokec4 , \cf8 \strokec8 'software'\cf4 \strokec4 , \cf8 \strokec8 'tech'\cf4 \strokec4 , \cf8 \strokec8 'GPT'\cf4 \strokec4 , \cf8 \strokec8 'ChatGPT'\cf4 \strokec4 , \cf8 \strokec8 'coding'\cf4 \strokec4 , \cf8 \strokec8 'programming'\cf4 \strokec4 ],\cb1 \
\cb3       \cf7 \strokec7 questions\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 topComments\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 sentiment\cf4 \strokec4 : \{ \cf7 \strokec7 positive\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 negative\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4  \}\cb1 \
\cb3     \},\cb1 \
\cb3     \cf8 \strokec8 'Money/Finance'\cf4 \strokec4 : \{\cb1 \
\cb3       \cf7 \strokec7 keywords\cf4 \strokec4 : [\cf8 \strokec8 'money'\cf4 \strokec4 , \cf8 \strokec8 'dollar'\cf4 \strokec4 , \cf8 \strokec8 'cost'\cf4 \strokec4 , \cf8 \strokec8 'price'\cf4 \strokec4 , \cf8 \strokec8 'expensive'\cf4 \strokec4 , \cf8 \strokec8 'cheap'\cf4 \strokec4 , \cf8 \strokec8 'invest'\cf4 \strokec4 , \cf8 \strokec8 'profit'\cf4 \strokec4 , \cf8 \strokec8 'salary'\cf4 \strokec4 , \cf8 \strokec8 'income'\cf4 \strokec4 , \cf8 \strokec8 'financial'\cf4 \strokec4 , \cf8 \strokec8 'economy'\cf4 \strokec4 , \cf8 \strokec8 'inflation'\cf4 \strokec4 ],\cb1 \
\cb3       \cf7 \strokec7 questions\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 topComments\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 sentiment\cf4 \strokec4 : \{ \cf7 \strokec7 positive\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 negative\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4  \}\cb1 \
\cb3     \},\cb1 \
\cb3     \cf8 \strokec8 'Work/Career'\cf4 \strokec4 : \{\cb1 \
\cb3       \cf7 \strokec7 keywords\cf4 \strokec4 : [\cf8 \strokec8 'job'\cf4 \strokec4 , \cf8 \strokec8 'work'\cf4 \strokec4 , \cf8 \strokec8 'career'\cf4 \strokec4 , \cf8 \strokec8 'boss'\cf4 \strokec4 , \cf8 \strokec8 'employee'\cf4 \strokec4 , \cf8 \strokec8 'company'\cf4 \strokec4 , \cf8 \strokec8 'business'\cf4 \strokec4 , \cf8 \strokec8 'industry'\cf4 \strokec4 , \cf8 \strokec8 'hire'\cf4 \strokec4 , \cf8 \strokec8 'fired'\cf4 \strokec4 , \cf8 \strokec8 'remote'\cf4 \strokec4 , \cf8 \strokec8 'office'\cf4 \strokec4 , \cf8 \strokec8 'promotion'\cf4 \strokec4 ],\cb1 \
\cb3       \cf7 \strokec7 questions\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 topComments\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 sentiment\cf4 \strokec4 : \{ \cf7 \strokec7 positive\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 negative\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4  \}\cb1 \
\cb3     \},\cb1 \
\cb3     \cf8 \strokec8 'Health/Wellness'\cf4 \strokec4 : \{\cb1 \
\cb3       \cf7 \strokec7 keywords\cf4 \strokec4 : [\cf8 \strokec8 'health'\cf4 \strokec4 , \cf8 \strokec8 'doctor'\cf4 \strokec4 , \cf8 \strokec8 'medical'\cf4 \strokec4 , \cf8 \strokec8 'hospital'\cf4 \strokec4 , \cf8 \strokec8 'disease'\cf4 \strokec4 , \cf8 \strokec8 'treatment'\cf4 \strokec4 , \cf8 \strokec8 'therapy'\cf4 \strokec4 , \cf8 \strokec8 'medicine'\cf4 \strokec4 , \cf8 \strokec8 'mental health'\cf4 \strokec4 , \cf8 \strokec8 'anxiety'\cf4 \strokec4 , \cf8 \strokec8 'depression'\cf4 \strokec4 , \cf8 \strokec8 'fitness'\cf4 \strokec4 ],\cb1 \
\cb3       \cf7 \strokec7 questions\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 topComments\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 sentiment\cf4 \strokec4 : \{ \cf7 \strokec7 positive\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 negative\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4  \}\cb1 \
\cb3     \},\cb1 \
\cb3     \cf8 \strokec8 'Education'\cf4 \strokec4 : \{\cb1 \
\cb3       \cf7 \strokec7 keywords\cf4 \strokec4 : [\cf8 \strokec8 'school'\cf4 \strokec4 , \cf8 \strokec8 'university'\cf4 \strokec4 , \cf8 \strokec8 'college'\cf4 \strokec4 , \cf8 \strokec8 'student'\cf4 \strokec4 , \cf8 \strokec8 'teacher'\cf4 \strokec4 , \cf8 \strokec8 'education'\cf4 \strokec4 , \cf8 \strokec8 'learn'\cf4 \strokec4 , \cf8 \strokec8 'course'\cf4 \strokec4 , \cf8 \strokec8 'degree'\cf4 \strokec4 , \cf8 \strokec8 'study'\cf4 \strokec4 , \cf8 \strokec8 'exam'\cf4 \strokec4 , \cf8 \strokec8 'graduate'\cf4 \strokec4 ],\cb1 \
\cb3       \cf7 \strokec7 questions\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 topComments\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 sentiment\cf4 \strokec4 : \{ \cf7 \strokec7 positive\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 negative\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4  \}\cb1 \
\cb3     \}\cb1 \
\cb3   \};\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Initialize theme data\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 Object\cf4 \strokec4 .\cf7 \strokec7 keys\cf4 \strokec4 (\cf7 \strokec7 themeKeywords\cf4 \strokec4 ).\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 theme\cf4 \strokec4  => \{\cb1 \
\cb3     \cf7 \strokec7 themeData\cf4 \strokec4 [\cf7 \strokec7 theme\cf4 \strokec4 ] = \{\cb1 \
\cb3       \cf7 \strokec7 count\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 questions\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 topComments\cf4 \strokec4 : [],\cb1 \
\cb3       \cf7 \strokec7 sentiment\cf4 \strokec4 : \{ \cf7 \strokec7 positive\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 negative\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 neutral\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4  \},\cb1 \
\cb3       \cf7 \strokec7 keywords\cf4 \strokec4 : \cf7 \strokec7 themeKeywords\cf4 \strokec4 [\cf7 \strokec7 theme\cf4 \strokec4 ].\cf7 \strokec7 keywords\cf4 \cb1 \strokec4 \
\cb3     \};\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Analyze comments\cf4 \cb1 \strokec4 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 body\cf4 \strokec4  = (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ).\cf7 \strokec7 toLowerCase\cf4 \strokec4 ();\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 isQuestion\cf4 \strokec4  = \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 includes\cf4 \strokec4 (\cf8 \strokec8 '?'\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf6 \strokec6 Object\cf4 \strokec4 .\cf7 \strokec7 keys\cf4 \strokec4 (\cf7 \strokec7 themeKeywords\cf4 \strokec4 ).\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 theme\cf4 \strokec4  => \{\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 themeInfo\cf4 \strokec4  = \cf7 \strokec7 themeKeywords\cf4 \strokec4 [\cf7 \strokec7 theme\cf4 \strokec4 ];\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 hasKeyword\cf4 \strokec4  = \cf7 \strokec7 themeInfo\cf4 \strokec4 .\cf7 \strokec7 keywords\cf4 \strokec4 .\cf7 \strokec7 some\cf4 \strokec4 (\cf7 \strokec7 keyword\cf4 \strokec4  => \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 includes\cf4 \strokec4 (\cf7 \strokec7 keyword\cf4 \strokec4 .\cf7 \strokec7 toLowerCase\cf4 \strokec4 ()));\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 hasKeyword\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 themeData\cf4 \strokec4 [\cf7 \strokec7 theme\cf4 \strokec4 ].\cf7 \strokec7 count\cf4 \strokec4 ++;\cb1 \
\cb3         \cb1 \
\cb3         \cf2 \strokec2 // Collect questions\cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 isQuestion\cf4 \strokec4  && \cf7 \strokec7 themeData\cf4 \strokec4 [\cf7 \strokec7 theme\cf4 \strokec4 ].\cf7 \strokec7 questions\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  < \cf9 \strokec9 3\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf7 \strokec7 themeData\cf4 \strokec4 [\cf7 \strokec7 theme\cf4 \strokec4 ].\cf7 \strokec7 questions\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3             \cf7 \strokec7 text\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 200\cf4 \strokec4 ) + (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 200\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3             \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3             \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \cb1 \strokec4 \
\cb3           \});\cb1 \
\cb3         \}\cb1 \
\cb3         \cb1 \
\cb3         \cf2 \strokec2 // Collect top comments\cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  > \cf9 \strokec9 50\cf4 \strokec4  && \cf7 \strokec7 themeData\cf4 \strokec4 [\cf7 \strokec7 theme\cf4 \strokec4 ].\cf7 \strokec7 topComments\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  < \cf9 \strokec9 3\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf7 \strokec7 themeData\cf4 \strokec4 [\cf7 \strokec7 theme\cf4 \strokec4 ].\cf7 \strokec7 topComments\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3             \cf7 \strokec7 text\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 200\cf4 \strokec4 ) + (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 200\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3             \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3             \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3             \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3           \});\cb1 \
\cb3         \}\cb1 \
\cb3         \cb1 \
\cb3         \cf2 \strokec2 // Analyze sentiment\cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 sentiment\cf4 \strokec4  = \cf7 \strokec7 analyzeSentiment\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 );\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 sentiment\cf4 \strokec4 .\cf7 \strokec7 overall\cf4 \strokec4  === \cf8 \strokec8 'positive'\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf7 \strokec7 themeData\cf4 \strokec4 [\cf7 \strokec7 theme\cf4 \strokec4 ].\cf7 \strokec7 sentiment\cf4 \strokec4 .\cf7 \strokec7 positive\cf4 \strokec4 ++;\cb1 \
\cb3         \} \cf5 \strokec5 else\cf4 \strokec4  \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 sentiment\cf4 \strokec4 .\cf7 \strokec7 overall\cf4 \strokec4  === \cf8 \strokec8 'negative'\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf7 \strokec7 themeData\cf4 \strokec4 [\cf7 \strokec7 theme\cf4 \strokec4 ].\cf7 \strokec7 sentiment\cf4 \strokec4 .\cf7 \strokec7 negative\cf4 \strokec4 ++;\cb1 \
\cb3         \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3           \cf7 \strokec7 themeData\cf4 \strokec4 [\cf7 \strokec7 theme\cf4 \strokec4 ].\cf7 \strokec7 sentiment\cf4 \strokec4 .\cf7 \strokec7 neutral\cf4 \strokec4 ++;\cb1 \
\cb3         \}\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Convert to array and calculate percentages\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 themes\cf4 \strokec4  = \cf6 \strokec6 Object\cf4 \strokec4 .\cf7 \strokec7 entries\cf4 \strokec4 (\cf7 \strokec7 themeData\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 filter\cf4 \strokec4 (([\cf7 \strokec7 theme\cf4 \strokec4 , \cf7 \strokec7 data\cf4 \strokec4 ]) => \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 count\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 map\cf4 \strokec4 (([\cf7 \strokec7 theme\cf4 \strokec4 , \cf7 \strokec7 data\cf4 \strokec4 ]) => (\{\cb1 \
\cb3       \cf7 \strokec7 theme\cf4 \strokec4 : \cf7 \strokec7 theme\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 mentions\cf4 \strokec4 : \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 count\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 percentage\cf4 \strokec4 : \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 round\cf4 \strokec4 ((\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 count\cf4 \strokec4  / \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 ) * \cf9 \strokec9 100\cf4 \strokec4 ),\cb1 \
\cb3       \cf7 \strokec7 questions\cf4 \strokec4 : \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 questions\cf4 \strokec4 .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  - \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ).\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 2\cf4 \strokec4 ),\cb1 \
\cb3       \cf7 \strokec7 topComments\cf4 \strokec4 : \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 topComments\cf4 \strokec4 .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  - \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ).\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 2\cf4 \strokec4 ),\cb1 \
\cb3       \cf7 \strokec7 sentiment\cf4 \strokec4 : \{\cb1 \
\cb3         \cf7 \strokec7 positive\cf4 \strokec4 : \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 round\cf4 \strokec4 ((\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 sentiment\cf4 \strokec4 .\cf7 \strokec7 positive\cf4 \strokec4  / \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 count\cf4 \strokec4 ) * \cf9 \strokec9 100\cf4 \strokec4 ),\cb1 \
\cb3         \cf7 \strokec7 negative\cf4 \strokec4 : \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 round\cf4 \strokec4 ((\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 sentiment\cf4 \strokec4 .\cf7 \strokec7 negative\cf4 \strokec4  / \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 count\cf4 \strokec4 ) * \cf9 \strokec9 100\cf4 \strokec4 ),\cb1 \
\cb3         \cf7 \strokec7 neutral\cf4 \strokec4 : \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 round\cf4 \strokec4 ((\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 sentiment\cf4 \strokec4 .\cf7 \strokec7 neutral\cf4 \strokec4  / \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 count\cf4 \strokec4 ) * \cf9 \strokec9 100\cf4 \strokec4 )\cb1 \
\cb3       \}\cb1 \
\cb3     \}))\cb1 \
\cb3     .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 mentions\cf4 \strokec4  - \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 mentions\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 5\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 themes\cf4 \strokec4 ;\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Keep all existing extraction functions below...\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 // (extractLinksWithContext, extractContentGoldmines, extractEntrepreneurialOpportunities, \cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 //  extractFunnyMoments, extractDeepRealizations, extractExpertInsights, \cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 //  extractMoneyMentions, analyzeSentiment)\cf4 \cb1 \strokec4 \
\
\cf2 \cb3 \strokec2 // Enhanced link extraction with context\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractLinksWithContext\cf4 \strokec4 (\cf7 \strokec7 posts\cf4 \strokec4 , \cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 urlRegex\cf4 \strokec4  = \cf10 \strokec10 /https?:\\/\\/[^\\s\\)\\]\\\}\\>\\<\\"\\'\\`]+/\cf5 \strokec5 g\cf4 \strokec4 ;\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 linksWithContext\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  && \cf5 \strokec5 typeof\cf4 \strokec4  \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  === \cf8 \strokec8 'string'\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 urls\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 match\cf4 \strokec4 (\cf7 \strokec7 urlRegex\cf4 \strokec4 ) || [];\cb1 \
\cb3       \cf7 \strokec7 urls\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 url\cf4 \strokec4  => \{\cb1 \
\cb3         \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 cleanUrl\cf4 \strokec4  = \cf7 \strokec7 url\cf4 \strokec4 .\cf7 \strokec7 replace\cf4 \strokec4 (\cf10 \strokec10 /[.,;!?)\\]\}\\>\\<\\"\\'\\`]+$/\cf4 \strokec4 , \cf8 \strokec8 ''\cf4 \strokec4 );\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 cleanUrl\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 15\cf4 \strokec4  &&\cb1 \
\cb3             !\cf7 \strokec7 cleanUrl\cf4 \strokec4 .\cf7 \strokec7 includes\cf4 \strokec4 (\cf8 \strokec8 'reddit.com'\cf4 \strokec4 ) && \cb1 \
\cb3             !\cf7 \strokec7 cleanUrl\cf4 \strokec4 .\cf7 \strokec7 includes\cf4 \strokec4 (\cf8 \strokec8 'imgur.com'\cf4 \strokec4 ) && \cb1 \
\cb3             !\cf7 \strokec7 cleanUrl\cf4 \strokec4 .\cf7 \strokec7 includes\cf4 \strokec4 (\cf8 \strokec8 'i.redd.it'\cf4 \strokec4 ) &&\cb1 \
\cb3             !\cf7 \strokec7 cleanUrl\cf4 \strokec4 .\cf7 \strokec7 includes\cf4 \strokec4 (\cf8 \strokec8 'v.redd.it'\cf4 \strokec4 )) \{\cb1 \
\cb3           \cb1 \
\cb3           \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 linkIndex\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 indexOf\cf4 \strokec4 (\cf7 \strokec7 url\cf4 \strokec4 );\cb1 \
\cb3           \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 contextStart\cf4 \strokec4  = \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 max\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 linkIndex\cf4 \strokec4  - \cf9 \strokec9 50\cf4 \strokec4 );\cb1 \
\cb3           \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 contextEnd\cf4 \strokec4  = \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 min\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 , \cf7 \strokec7 linkIndex\cf4 \strokec4  + \cf7 \strokec7 url\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  + \cf9 \strokec9 50\cf4 \strokec4 );\cb1 \
\cb3           \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 context\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf7 \strokec7 contextStart\cf4 \strokec4 , \cf7 \strokec7 contextEnd\cf4 \strokec4 ).\cf7 \strokec7 replace\cf4 \strokec4 (\cf10 \strokec10 /\\n/\cf5 \strokec5 g\cf4 \strokec4 , \cf8 \strokec8 ' '\cf4 \strokec4 ).\cf7 \strokec7 trim\cf4 \strokec4 ();\cb1 \
\cb3           \cb1 \
\cb3           \cf7 \strokec7 linksWithContext\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3             \cf7 \strokec7 url\cf4 \strokec4 : \cf7 \strokec7 cleanUrl\cf4 \strokec4 ,\cb1 \
\cb3             \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3             \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3             \cf7 \strokec7 context\cf4 \strokec4 : \cf7 \strokec7 context\cf4 \strokec4 ,\cb1 \
\cb3             \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3           \});\cb1 \
\cb3         \}\cb1 \
\cb3       \});\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 linksWithContext\cf4 \strokec4 .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  - \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 );\cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 linksWithContext\cf4 \strokec4 .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractContentGoldmines\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 goldmines\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 body\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 score\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 score\cf4 \strokec4  > \cf9 \strokec9 100\cf4 \strokec4  && \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 100\cf4 \strokec4  && \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  < \cf9 \strokec9 1000\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 hasStoryElements\cf4 \strokec4  = \cf10 \strokec10 /\\b(I |we |my |our |happened|realized|learned|discovered|found out)\\b/\cf5 \strokec5 i\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 hasInsightElements\cf4 \strokec4  = \cf10 \strokec10 /\\b(actually|turns out|people don't realize|most people|the truth is|the key is|the secret is)\\b/\cf5 \strokec5 i\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 );\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 hasStoryElements\cf4 \strokec4  || \cf7 \strokec7 hasInsightElements\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 goldmines\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3           \cf7 \strokec7 type\cf4 \strokec4 : \cf7 \strokec7 hasStoryElements\cf4 \strokec4  ? \cf8 \strokec8 'story'\cf4 \strokec4  : \cf8 \strokec8 'insight'\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 content\cf4 \strokec4 : \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 500\cf4 \strokec4 ) + (\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 500\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3           \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3         \});\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 goldmines\cf4 \strokec4 .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  - \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ).\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractEntrepreneurialOpportunities\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 opportunities\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 opportunityPatterns\cf4 \strokec4  = [\cb1 \
\cb3     \cf10 \strokec10 /\\b(nobody is|no one is|somebody should|someone should|wish there was|wish someone would|need[s]? to be|should exist)\\b/\cf5 \strokec5 i\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\\b(gap in the market|underserved|overlooked|huge opportunity|untapped|gold mine)\\b/\cf5 \strokec5 i\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\\b(would pay for|willing to pay|shut up and take my money|worth paying)\\b/\cf5 \strokec5 i\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\\b(frustrat\\w+|annoying|painful|sucks|broken|doesn't work|waste[s]? time)\\b.*\\b(solution|fix|solve|better way)\\b/\cf5 \strokec5 i\cf4 \cb1 \strokec4 \
\cb3   ];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 body\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf7 \strokec7 opportunityPatterns\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 pattern\cf4 \strokec4  => \{\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 pattern\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \{\cb1 \
\cb3         \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 sentences\cf4 \strokec4  = \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 split\cf4 \strokec4 (\cf10 \strokec10 /[.!?]+/\cf4 \strokec4 );\cb1 \
\cb3         \cf7 \strokec7 sentences\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 sentence\cf4 \strokec4  => \{\cb1 \
\cb3           \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 pattern\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 sentence\cf4 \strokec4 ) && \cf7 \strokec7 sentence\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 20\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 opportunities\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3               \cf7 \strokec7 opportunity\cf4 \strokec4 : \cf7 \strokec7 sentence\cf4 \strokec4 .\cf7 \strokec7 trim\cf4 \strokec4 (),\cb1 \
\cb3               \cf7 \strokec7 fullContext\cf4 \strokec4 : \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 300\cf4 \strokec4 ) + (\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 300\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3               \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3               \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ,\cb1 \
\cb3               \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3             \});\cb1 \
\cb3           \}\cb1 \
\cb3         \});\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 uniqueOpportunities\cf4 \strokec4  = \cf7 \strokec7 opportunities\cf4 \strokec4 .\cf7 \strokec7 reduce\cf4 \strokec4 ((\cf7 \strokec7 acc\cf4 \strokec4 , \cf7 \strokec7 curr\cf4 \strokec4 ) => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 exists\cf4 \strokec4  = \cf7 \strokec7 acc\cf4 \strokec4 .\cf7 \strokec7 find\cf4 \strokec4 (\cf7 \strokec7 item\cf4 \strokec4  => \cb1 \
\cb3       \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 opportunity\cf4 \strokec4 .\cf7 \strokec7 toLowerCase\cf4 \strokec4 () === \cf7 \strokec7 curr\cf4 \strokec4 .\cf7 \strokec7 opportunity\cf4 \strokec4 .\cf7 \strokec7 toLowerCase\cf4 \strokec4 ()\cb1 \
\cb3     );\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (!\cf7 \strokec7 exists\cf4 \strokec4 ) \cf7 \strokec7 acc\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\cf7 \strokec7 curr\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 acc\cf4 \strokec4 ;\cb1 \
\cb3   \}, []);\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 uniqueOpportunities\cf4 \strokec4 .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  - \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ).\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractFunnyMoments\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 funnyMoments\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 humorIndicators\cf4 \strokec4  = [\cb1 \
\cb3     \cf10 \strokec10 /\\b(lol|lmao|lmfao|haha|\uc0\u55357 \u56834 |\u55358 \u56611 |hilarious|comedy gold|spit out|lost it|dying|can't stop laughing)\\b/\cf5 \strokec5 i\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\\b(plot twist|wait what|had us in the first half|unexpected|didn't see that coming)\\b/\cf5 \strokec5 i\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /^(r\\/[a-zA-Z]+)$/\cf5 \strokec5 m\cf4 \cb1 \strokec4 \
\cb3   ];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 body\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 score\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 score\cf4 \strokec4  > \cf9 \strokec9 50\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 humorScore\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 humorIndicators\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 pattern\cf4 \strokec4  => \{\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 pattern\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \cf7 \strokec7 humorScore\cf4 \strokec4 ++;\cb1 \
\cb3       \});\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  < \cf9 \strokec9 200\cf4 \strokec4  && \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 10\cf4 \strokec4 ) \cf7 \strokec7 humorScore\cf4 \strokec4 ++;\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 includes\cf4 \strokec4 (\cf8 \strokec8 '"'\cf4 \strokec4 ) && \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 split\cf4 \strokec4 (\cf8 \strokec8 '"'\cf4 \strokec4 ).\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 2\cf4 \strokec4 ) \cf7 \strokec7 humorScore\cf4 \strokec4 ++;\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 humorScore\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 funnyMoments\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3           \cf7 \strokec7 content\cf4 \strokec4 : \cf7 \strokec7 body\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 humorScore\cf4 \strokec4 : \cf7 \strokec7 humorScore\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3         \});\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 funnyMoments\cf4 \cb1 \strokec4 \
\cb3     .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => (\cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  * \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 humorScore\cf4 \strokec4 ) - (\cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  * \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 humorScore\cf4 \strokec4 ))\cb1 \
\cb3     .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractDeepRealizations\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 realizations\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 deepPatterns\cf4 \strokec4  = [\cb1 \
\cb3     \cf10 \strokec10 /\\b(realized|realize|revelation|epiphany|changed my perspective|opened my eyes|never thought about|made me think)\\b/\cf5 \strokec5 i\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\\b(the real|the actual|the true|fundamentally|essentially|at its core|when you think about it)\\b/\cf5 \strokec5 i\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\\b(life lesson|learned that|taught me|wisdom|profound|deep truth|universal truth)\\b/\cf5 \strokec5 i\cf4 \cb1 \strokec4 \
\cb3   ];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 body\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 score\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 score\cf4 \strokec4  > \cf9 \strokec9 50\cf4 \strokec4  && \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 150\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 depthScore\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 deepPatterns\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 pattern\cf4 \strokec4  => \{\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 pattern\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \cf7 \strokec7 depthScore\cf4 \strokec4 ++;\cb1 \
\cb3       \});\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 depthScore\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 realizations\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3           \cf7 \strokec7 insight\cf4 \strokec4 : \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 500\cf4 \strokec4 ) + (\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 500\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3           \cf7 \strokec7 depthScore\cf4 \strokec4 : \cf7 \strokec7 depthScore\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3         \});\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 realizations\cf4 \cb1 \strokec4 \
\cb3     .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => (\cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  * \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 depthScore\cf4 \strokec4 ) - (\cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  * \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 depthScore\cf4 \strokec4 ))\cb1 \
\cb3     .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractExpertInsights\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 expertComments\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 expertIndicators\cf4 \strokec4  = [\cb1 \
\cb3     \cf10 \strokec10 /\\b(I work in|I'm a|I am a|as a|I've been|years of experience|professional|expert)\\b/\cf5 \strokec5 i\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\\b(source:|actually|technically|specifically|to clarify|to be precise)\\b/\cf5 \strokec5 i\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\\b(PhD|doctor|engineer|developer|analyst|researcher|scientist|professor)\\b/\cf5 \strokec5 i\cf4 \cb1 \strokec4 \
\cb3   ];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 body\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 score\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 score\cf4 \strokec4  > \cf9 \strokec9 30\cf4 \strokec4  && \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 200\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 expertScore\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3       \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 credentials\cf4 \strokec4  = \cf8 \strokec8 ''\cf4 \strokec4 ;\cb1 \
\cb3       \cb1 \
\cb3       \cf7 \strokec7 expertIndicators\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 pattern\cf4 \strokec4  => \{\cb1 \
\cb3         \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 match\cf4 \strokec4  = \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 match\cf4 \strokec4 (\cf7 \strokec7 pattern\cf4 \strokec4 );\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 match\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf7 \strokec7 expertScore\cf4 \strokec4 ++;\cb1 \
\cb3           \cf5 \strokec5 if\cf4 \strokec4  (!\cf7 \strokec7 credentials\cf4 \strokec4  && \cf7 \strokec7 match\cf4 \strokec4 [\cf9 \strokec9 0\cf4 \strokec4 ]) \{\cb1 \
\cb3             \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 startIdx\cf4 \strokec4  = \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 max\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 match\cf4 \strokec4 .\cf7 \strokec7 index\cf4 \strokec4  - \cf9 \strokec9 20\cf4 \strokec4 );\cb1 \
\cb3             \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 endIdx\cf4 \strokec4  = \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 min\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 , \cf7 \strokec7 match\cf4 \strokec4 .\cf7 \strokec7 index\cf4 \strokec4  + \cf9 \strokec9 100\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 credentials\cf4 \strokec4  = \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf7 \strokec7 startIdx\cf4 \strokec4 , \cf7 \strokec7 endIdx\cf4 \strokec4 ).\cf7 \strokec7 replace\cf4 \strokec4 (\cf10 \strokec10 /\\n/\cf5 \strokec5 g\cf4 \strokec4 , \cf8 \strokec8 ' '\cf4 \strokec4 ).\cf7 \strokec7 trim\cf4 \strokec4 ();\cb1 \
\cb3           \}\cb1 \
\cb3         \}\cb1 \
\cb3       \});\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /\\n[-*\'95]|\\n\\d+\\./\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \cf7 \strokec7 expertScore\cf4 \strokec4 ++;\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 expertScore\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 expertComments\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3           \cf7 \strokec7 content\cf4 \strokec4 : \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 500\cf4 \strokec4 ) + (\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 500\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3           \cf7 \strokec7 credentials\cf4 \strokec4 : \cf7 \strokec7 credentials\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 expertScore\cf4 \strokec4 : \cf7 \strokec7 expertScore\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3         \});\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 expertComments\cf4 \cb1 \strokec4 \
\cb3     .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => (\cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  * \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 expertScore\cf4 \strokec4 ) - (\cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  * \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 expertScore\cf4 \strokec4 ))\cb1 \
\cb3     .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractMoneyMentions\cf4 \strokec4 (\cf7 \strokec7 text\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 if\cf4 \strokec4  (!\cf7 \strokec7 text\cf4 \strokec4  || \cf5 \strokec5 typeof\cf4 \strokec4  \cf7 \strokec7 text\cf4 \strokec4  !== \cf8 \strokec8 'string'\cf4 \strokec4 ) \cf5 \strokec5 return\cf4 \strokec4  [];\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 patterns\cf4 \strokec4  = [\cb1 \
\cb3     \cf10 \strokec10 /\\$[\\d,]+(?:\\.\\d\{1,2\})?(?:\\s*(?:K|k|M|m|B|b|million|billion|thousand))?/\cf5 \strokec5 g\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\uc0\u8377 [\\d,]+(?:\\.\\d\{1,2\})?(?:\\s*(?:K|k|M|m|B|b|crore|lakh))?/\cf5 \strokec5 g\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /[\\d,]+(?:\\.\\d\{1,2\})?\\s*(?:dollars?|USD|usd|rupees?|INR)/\cf5 \strokec5 g\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /[\\d,]+(?:\\.\\d\{1,2\})?\\s*(?:K|M|B)\\s*(?:revenue|profit|ARR|MRR|valuation|salary)/\cf5 \strokec5 g\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\\d+(?:,\\d\{3\})*\\s*(?:%|percent)/\cf5 \strokec5 g\cf4 \cb1 \strokec4 \
\cb3   ];\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 matches\cf4 \strokec4  = [];\cb1 \
\cb3   \cf7 \strokec7 patterns\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 pattern\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 found\cf4 \strokec4  = \cf7 \strokec7 text\cf4 \strokec4 .\cf7 \strokec7 match\cf4 \strokec4 (\cf7 \strokec7 pattern\cf4 \strokec4 ) || [];\cb1 \
\cb3     \cf7 \strokec7 matches\cf4 \strokec4  = \cf7 \strokec7 matches\cf4 \strokec4 .\cf7 \strokec7 concat\cf4 \strokec4 (\cf7 \strokec7 found\cf4 \strokec4 );\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  [...\cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Set\cf4 \strokec4 (\cf7 \strokec7 matches\cf4 \strokec4 )]\cb1 \
\cb3     .\cf7 \strokec7 map\cf4 \strokec4 (\cf7 \strokec7 match\cf4 \strokec4  => \cf7 \strokec7 match\cf4 \strokec4 .\cf7 \strokec7 trim\cf4 \strokec4 ())\cb1 \
\cb3     .\cf7 \strokec7 filter\cf4 \strokec4 (\cf7 \strokec7 match\cf4 \strokec4  => \cf7 \strokec7 match\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 1\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 15\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 analyzeSentiment\cf4 \strokec4 (\cf7 \strokec7 text\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 if\cf4 \strokec4  (!\cf7 \strokec7 text\cf4 \strokec4  || \cf5 \strokec5 typeof\cf4 \strokec4  \cf7 \strokec7 text\cf4 \strokec4  !== \cf8 \strokec8 'string'\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \{ \cf7 \strokec7 positive\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 negative\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 overall\cf4 \strokec4 : \cf8 \strokec8 'neutral'\cf4 \strokec4 , \cf7 \strokec7 ratio\cf4 \strokec4 : \cf9 \strokec9 50\cf4 \strokec4  \};\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 positiveWords\cf4 \strokec4  = [\cb1 \
\cb3     \cf8 \strokec8 'great'\cf4 \strokec4 , \cf8 \strokec8 'awesome'\cf4 \strokec4 , \cf8 \strokec8 'good'\cf4 \strokec4 , \cf8 \strokec8 'love'\cf4 \strokec4 , \cf8 \strokec8 'amazing'\cf4 \strokec4 , \cf8 \strokec8 'excellent'\cf4 \strokec4 , \cf8 \strokec8 'perfect'\cf4 \strokec4 , \cf8 \strokec8 'wonderful'\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 'success'\cf4 \strokec4 , \cf8 \strokec8 'successful'\cf4 \strokec4 , \cf8 \strokec8 'profitable'\cf4 \strokec4 , \cf8 \strokec8 'booming'\cf4 \strokec4 , \cf8 \strokec8 'growing'\cf4 \strokec4 , \cf8 \strokec8 'opportunity'\cf4 \strokec4 , \cf8 \strokec8 'valuable'\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 'incredible'\cf4 \strokec4 , \cf8 \strokec8 'fantastic'\cf4 \strokec4 , \cf8 \strokec8 'outstanding'\cf4 \strokec4 , \cf8 \strokec8 'impressive'\cf4 \strokec4 , \cf8 \strokec8 'brilliant'\cf4 \strokec4 , \cf8 \strokec8 'helpful'\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 'useful'\cf4 \strokec4 , \cf8 \strokec8 'effective'\cf4 \strokec4 , \cf8 \strokec8 'efficient'\cf4 \strokec4 , \cf8 \strokec8 'innovative'\cf4 \strokec4 , \cf8 \strokec8 'revolutionary'\cf4 \strokec4 , \cf8 \strokec8 'game-changing'\cf4 \cb1 \strokec4 \
\cb3   ];\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 negativeWords\cf4 \strokec4  = [\cb1 \
\cb3     \cf8 \strokec8 'bad'\cf4 \strokec4 , \cf8 \strokec8 'awful'\cf4 \strokec4 , \cf8 \strokec8 'terrible'\cf4 \strokec4 , \cf8 \strokec8 'hate'\cf4 \strokec4 , \cf8 \strokec8 'worst'\cf4 \strokec4 , \cf8 \strokec8 'horrible'\cf4 \strokec4 , \cf8 \strokec8 'disgusting'\cf4 \strokec4 , \cf8 \strokec8 'trash'\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 'failed'\cf4 \strokec4 , \cf8 \strokec8 'failure'\cf4 \strokec4 , \cf8 \strokec8 'struggling'\cf4 \strokec4 , \cf8 \strokec8 'difficult'\cf4 \strokec4 , \cf8 \strokec8 'problem'\cf4 \strokec4 , \cf8 \strokec8 'challenging'\cf4 \strokec4 , \cf8 \strokec8 'impossible'\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 'frustrating'\cf4 \strokec4 , \cf8 \strokec8 'annoying'\cf4 \strokec4 , \cf8 \strokec8 'disappointing'\cf4 \strokec4 , \cf8 \strokec8 'useless'\cf4 \strokec4 , \cf8 \strokec8 'broken'\cf4 \strokec4 , \cf8 \strokec8 'disaster'\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 'nightmare'\cf4 \strokec4 , \cf8 \strokec8 'painful'\cf4 \strokec4 , \cf8 \strokec8 'expensive'\cf4 \strokec4 , \cf8 \strokec8 'overpriced'\cf4 \strokec4 , \cf8 \strokec8 'scam'\cf4 \strokec4 , \cf8 \strokec8 'waste'\cf4 \cb1 \strokec4 \
\cb3   ];\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 words\cf4 \strokec4  = \cf7 \strokec7 text\cf4 \strokec4 .\cf7 \strokec7 toLowerCase\cf4 \strokec4 ().\cf7 \strokec7 split\cf4 \strokec4 (\cf10 \strokec10 /\\s+/\cf4 \strokec4 );\cb1 \
\cb3   \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 positive\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3   \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 negative\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 words\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 word\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 positiveWords\cf4 \strokec4 .\cf7 \strokec7 includes\cf4 \strokec4 (\cf7 \strokec7 word\cf4 \strokec4 )) \cf7 \strokec7 positive\cf4 \strokec4 ++;\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 negativeWords\cf4 \strokec4 .\cf7 \strokec7 includes\cf4 \strokec4 (\cf7 \strokec7 word\cf4 \strokec4 )) \cf7 \strokec7 negative\cf4 \strokec4 ++;\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 total\cf4 \strokec4  = \cf7 \strokec7 positive\cf4 \strokec4  + \cf7 \strokec7 negative\cf4 \strokec4 ;\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 ratio\cf4 \strokec4  = \cf7 \strokec7 total\cf4 \strokec4  > \cf9 \strokec9 0\cf4 \strokec4  ? \cf6 \strokec6 Math\cf4 \strokec4 .\cf7 \strokec7 round\cf4 \strokec4 ((\cf7 \strokec7 positive\cf4 \strokec4  / \cf7 \strokec7 total\cf4 \strokec4 ) * \cf9 \strokec9 100\cf4 \strokec4 ) : \cf9 \strokec9 50\cf4 \strokec4 ;\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \{\cb1 \
\cb3     \cf7 \strokec7 positive\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 negative\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 overall\cf4 \strokec4 : \cf7 \strokec7 positive\cf4 \strokec4  > \cf7 \strokec7 negative\cf4 \strokec4  ? \cf8 \strokec8 'positive'\cf4 \strokec4  : \cf7 \strokec7 negative\cf4 \strokec4  > \cf7 \strokec7 positive\cf4 \strokec4  ? \cf8 \strokec8 'negative'\cf4 \strokec4  : \cf8 \strokec8 'neutral'\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 ratio\cf4 \strokec4 : \cf7 \strokec7 ratio\cf4 \cb1 \strokec4 \
\cb3   \};\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Test function\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 testRedditAuth\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 try\cf4 \strokec4  \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 token\cf4 \strokec4  = \cf7 \strokec7 getRedditAccessToken\cf4 \strokec4 ();\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Successfully authenticated! Token:'\cf4 \strokec4 , \cf7 \strokec7 token\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 ) + \cf8 \strokec8 '...'\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf5 \strokec5 true\cf4 \strokec4 ;\cb1 \
\cb3   \} \cf5 \strokec5 catch\cf4 \strokec4  (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf8 \strokec8 'Authentication failed:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf5 \strokec5 false\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 testDirectFetch\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 try\cf4 \strokec4  \{\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Test 1: Checking authentication...'\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 token\cf4 \strokec4  = \cf7 \strokec7 getRedditAccessToken\cf4 \strokec4 ();\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 '\uc0\u10003  Authentication successful'\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Test 2: Fetching Reddit data...'\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 testUrl\cf4 \strokec4  = \cf8 \strokec8 'https://oauth.reddit.com/r/AskReddit/hot.json?limit=1'\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 response\cf4 \strokec4  = \cf6 \strokec6 UrlFetchApp\cf4 \strokec4 .\cf7 \strokec7 fetch\cf4 \strokec4 (\cf7 \strokec7 testUrl\cf4 \strokec4 , \{\cb1 \
\cb3       \cf7 \strokec7 headers\cf4 \strokec4 : \{\cb1 \
\cb3         \cf8 \strokec8 'Authorization'\cf4 \strokec4 : \cf8 \strokec8 `bearer \cf4 \strokec4 $\{\cf7 \strokec7 token\cf4 \strokec4 \}\cf8 \strokec8 `\cf4 \strokec4 ,\cb1 \
\cb3         \cf8 \strokec8 'User-Agent'\cf4 \strokec4 : \cf6 \strokec6 REDDIT_CONFIG\cf4 \strokec4 .\cf7 \strokec7 userAgent\cf4 \cb1 \strokec4 \
\cb3       \},\cb1 \
\cb3       \cf7 \strokec7 muteHttpExceptions\cf4 \strokec4 : \cf5 \strokec5 true\cf4 \cb1 \strokec4 \
\cb3     \});\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 code\cf4 \strokec4  = \cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 getResponseCode\cf4 \strokec4 ();\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Response code:'\cf4 \strokec4 , \cf7 \strokec7 code\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 code\cf4 \strokec4  === \cf9 \strokec9 200\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 '\uc0\u10003  Reddit API is accessible'\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 data\cf4 \strokec4  = \cf6 \strokec6 JSON\cf4 \strokec4 .\cf7 \strokec7 parse\cf4 \strokec4 (\cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 getContentText\cf4 \strokec4 ());\cb1 \
\cb3       \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 '\uc0\u10003  Got data:'\cf4 \strokec4 , \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 , \cf8 \strokec8 'posts'\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 'SUCCESS: Reddit API is working'\cf4 \strokec4 ;\cb1 \
\cb3     \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3       \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 '\uc0\u10007  Reddit returned error:'\cf4 \strokec4 , \cf7 \strokec7 code\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf8 \strokec8 'Response:'\cf4 \strokec4 , \cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 getContentText\cf4 \strokec4 ().\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 200\cf4 \strokec4 ));\cb1 \
\cb3       \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 'ERROR: Reddit API returned '\cf4 \strokec4  + \cf7 \strokec7 code\cf4 \strokec4 ;\cb1 \
\cb3     \}\cb1 \
\cb3     \cb1 \
\cb3   \} \cf5 \strokec5 catch\cf4 \strokec4  (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf8 \strokec8 '\uc0\u10007  Test failed:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 'ERROR: '\cf4 \strokec4  + \cf7 \strokec7 error\cf4 \strokec4 .\cf7 \strokec7 toString\cf4 \strokec4 ();\cb1 \
\cb3   \}\cb1 \
\cb3 \}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Add simplified insights\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 try\cf4 \strokec4  \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 simplifiedInsights\cf4 \strokec4  = \cf7 \strokec7 extractWhatMatters\cf4 \strokec4 (\cf7 \strokec7 posts\cf4 \strokec4 , \cf7 \strokec7 validComments\cf4 \strokec4 );\cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 simplifiedInsights\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf2 \strokec2 // Merge simplified insights with existing ones\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 consensus\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 consensus\cf4 \strokec4  || [];\cb1 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 problems\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 problems\cf4 \strokec4  || [];\cb1 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 solutions\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 solutions\cf4 \strokec4  || [];\cb1 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 discussions\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 discussions\cf4 \strokec4  || [];\cb1 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 hiddenGems\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 hiddenGems\cf4 \strokec4  || [];\cb1 \
\cb3     \cf7 \strokec7 insights\cf4 \strokec4 .\cf7 \strokec7 patterns\cf4 \strokec4  = \cf7 \strokec7 simplifiedInsights\cf4 \strokec4 .\cf7 \strokec7 patterns\cf4 \strokec4  || [];\cb1 \
\cb3   \}\cb1 \
\cb3 \} \cf5 \strokec5 catch\cf4 \strokec4  (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3   \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf8 \strokec8 'Simplified extraction error:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3   \cf2 \strokec2 // Continue with existing insights if simplified fails\cf4 \cb1 \strokec4 \
\cb3 \}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // ========== NEW SIMPLIFIED EXTRACTION FUNCTIONS ==========\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractWhatMatters\cf4 \strokec4 (\cf7 \strokec7 posts\cf4 \strokec4 , \cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 return\cf4 \strokec4  \{\cb1 \
\cb3     \cf7 \strokec7 consensus\cf4 \strokec4 : \cf7 \strokec7 extractConsensus\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 problems\cf4 \strokec4 : \cf7 \strokec7 extractProblems\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 solutions\cf4 \strokec4 : \cf7 \strokec7 extractVerifiedSolutions\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 discussions\cf4 \strokec4 : \cf7 \strokec7 extractRealDiscussions\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 hiddenGems\cf4 \strokec4 : \cf7 \strokec7 extractHiddenGems\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ),\cb1 \
\cb3     \cf7 \strokec7 patterns\cf4 \strokec4 : \cf7 \strokec7 extractPatterns\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 )\cb1 \
\cb3   \};\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractConsensus\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 statements\cf4 \strokec4  = \{\};\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 body\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 sentences\cf4 \strokec4  = \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 split\cf4 \strokec4 (\cf10 \strokec10 /[.!?]+/\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf7 \strokec7 sentences\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 sentence\cf4 \strokec4  => \{\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 sentence\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 20\cf4 \strokec4  && \cf7 \strokec7 sentence\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  < \cf9 \strokec9 200\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /\\b(the best way|what works|always|never|everyone should)\\b/\cf5 \strokec5 i\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 sentence\cf4 \strokec4 )) \{\cb1 \
\cb3           \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 cleaned\cf4 \strokec4  = \cf7 \strokec7 sentence\cf4 \strokec4 .\cf7 \strokec7 trim\cf4 \strokec4 ().\cf7 \strokec7 toLowerCase\cf4 \strokec4 ().\cf7 \strokec7 replace\cf4 \strokec4 (\cf10 \strokec10 /[^a-z0-9\\s]/\cf5 \strokec5 g\cf4 \strokec4 , \cf8 \strokec8 ''\cf4 \strokec4 );\cb1 \
\cb3           \cb1 \
\cb3           \cf5 \strokec5 if\cf4 \strokec4  (!\cf7 \strokec7 statements\cf4 \strokec4 [\cf7 \strokec7 cleaned\cf4 \strokec4 ]) \{\cb1 \
\cb3             \cf7 \strokec7 statements\cf4 \strokec4 [\cf7 \strokec7 cleaned\cf4 \strokec4 ] = \{\cb1 \
\cb3               \cf7 \strokec7 text\cf4 \strokec4 : \cf7 \strokec7 sentence\cf4 \strokec4 .\cf7 \strokec7 trim\cf4 \strokec4 (),\cb1 \
\cb3               \cf7 \strokec7 mentions\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 ,\cb1 \
\cb3               \cf7 \strokec7 examples\cf4 \strokec4 : []\cb1 \
\cb3             \};\cb1 \
\cb3           \}\cb1 \
\cb3           \cb1 \
\cb3           \cf7 \strokec7 statements\cf4 \strokec4 [\cf7 \strokec7 cleaned\cf4 \strokec4 ].\cf7 \strokec7 mentions\cf4 \strokec4 ++;\cb1 \
\cb3           \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 statements\cf4 \strokec4 [\cf7 \strokec7 cleaned\cf4 \strokec4 ].\cf7 \strokec7 examples\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  < \cf9 \strokec9 3\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 statements\cf4 \strokec4 [\cf7 \strokec7 cleaned\cf4 \strokec4 ].\cf7 \strokec7 examples\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3               \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3               \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3               \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3             \});\cb1 \
\cb3           \}\cb1 \
\cb3         \}\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 Object\cf4 \strokec4 .\cf7 \strokec7 values\cf4 \strokec4 (\cf7 \strokec7 statements\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 filter\cf4 \strokec4 (\cf7 \strokec7 s\cf4 \strokec4  => \cf7 \strokec7 s\cf4 \strokec4 .\cf7 \strokec7 mentions\cf4 \strokec4  >= \cf9 \strokec9 3\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 mentions\cf4 \strokec4  - \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 mentions\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 5\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractProblems\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 problems\cf4 \strokec4  = [];\cb1 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 problemPatterns\cf4 \strokec4  = [\cb1 \
\cb3     \cf10 \strokec10 /\\b(can't|cannot|unable to|struggle with|hard to|difficult to)\\b/\cf5 \strokec5 i\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\\b(my problem is|the problem is|doesn't work|not working)\\b/\cf5 \strokec5 i\cf4 \strokec4 ,\cb1 \
\cb3     \cf10 \strokec10 /\\b(too tired|too anxious|too depressed|too scared)\\b/\cf5 \strokec5 i\cf4 \cb1 \strokec4 \
\cb3   ];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 body\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf7 \strokec7 problemPatterns\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 pattern\cf4 \strokec4  => \{\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 pattern\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \{\cb1 \
\cb3         \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 sentences\cf4 \strokec4  = \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 split\cf4 \strokec4 (\cf10 \strokec10 /[.!?]+/\cf4 \strokec4 );\cb1 \
\cb3         \cf7 \strokec7 sentences\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 sentence\cf4 \strokec4  => \{\cb1 \
\cb3           \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 pattern\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 sentence\cf4 \strokec4 ) && \cf7 \strokec7 sentence\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 20\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 problems\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3               \cf7 \strokec7 problem\cf4 \strokec4 : \cf7 \strokec7 sentence\cf4 \strokec4 .\cf7 \strokec7 trim\cf4 \strokec4 (),\cb1 \
\cb3               \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3               \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3               \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3             \});\cb1 \
\cb3           \}\cb1 \
\cb3         \});\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf2 \strokec2 // Group similar problems\cf4 \cb1 \strokec4 \
\cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 grouped\cf4 \strokec4  = \{\};\cb1 \
\cb3   \cf7 \strokec7 problems\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 p\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 key\cf4 \strokec4  = \cf7 \strokec7 p\cf4 \strokec4 .\cf7 \strokec7 problem\cf4 \strokec4 .\cf7 \strokec7 toLowerCase\cf4 \strokec4 ().\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 50\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (!\cf7 \strokec7 grouped\cf4 \strokec4 [\cf7 \strokec7 key\cf4 \strokec4 ]) \{\cb1 \
\cb3       \cf7 \strokec7 grouped\cf4 \strokec4 [\cf7 \strokec7 key\cf4 \strokec4 ] = \{\cb1 \
\cb3         \cf7 \strokec7 problem\cf4 \strokec4 : \cf7 \strokec7 p\cf4 \strokec4 .\cf7 \strokec7 problem\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 count\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 examples\cf4 \strokec4 : []\cb1 \
\cb3       \};\cb1 \
\cb3     \}\cb1 \
\cb3     \cf7 \strokec7 grouped\cf4 \strokec4 [\cf7 \strokec7 key\cf4 \strokec4 ].\cf7 \strokec7 count\cf4 \strokec4 ++;\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 grouped\cf4 \strokec4 [\cf7 \strokec7 key\cf4 \strokec4 ].\cf7 \strokec7 examples\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  < \cf9 \strokec9 3\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \strokec7 grouped\cf4 \strokec4 [\cf7 \strokec7 key\cf4 \strokec4 ].\cf7 \strokec7 examples\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\cf7 \strokec7 p\cf4 \strokec4 );\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 Object\cf4 \strokec4 .\cf7 \strokec7 values\cf4 \strokec4 (\cf7 \strokec7 grouped\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 filter\cf4 \strokec4 (\cf7 \strokec7 p\cf4 \strokec4  => \cf7 \strokec7 p\cf4 \strokec4 .\cf7 \strokec7 count\cf4 \strokec4  >= \cf9 \strokec9 2\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 count\cf4 \strokec4  - \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 count\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractVerifiedSolutions\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 solutions\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 body\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 score\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 score\cf4 \strokec4  > \cf9 \strokec9 20\cf4 \strokec4  && \cf10 \strokec10 /\\b(this works|worked for me|try this|the solution)\\b/\cf5 \strokec5 i\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \{\cb1 \
\cb3       \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 confirmations\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3       \cb1 \
\cb3       \cf2 \strokec2 // Check replies for confirmations\cf4 \cb1 \strokec4 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4  && \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 reply\cf4 \strokec4  => \{\cb1 \
\cb3           \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 reply\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 reply\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /\\b(works|confirm|thanks|helped)\\b/\cf5 \strokec5 i\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 reply\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 )) \{\cb1 \
\cb3               \cf7 \strokec7 confirmations\cf4 \strokec4 ++;\cb1 \
\cb3             \}\cb1 \
\cb3           \}\cb1 \
\cb3         \});\cb1 \
\cb3       \}\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 confirmations\cf4 \strokec4  >= \cf9 \strokec9 2\cf4 \strokec4  || \cf7 \strokec7 score\cf4 \strokec4  > \cf9 \strokec9 100\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 solutions\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3           \cf7 \strokec7 solution\cf4 \strokec4 : \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 300\cf4 \strokec4 ) + (\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 300\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3           \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 confirmations\cf4 \strokec4 : \cf7 \strokec7 confirmations\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3         \});\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 solutions\cf4 \cb1 \strokec4 \
\cb3     .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => (\cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 confirmations\cf4 \strokec4  * \cf9 \strokec9 10\cf4 \strokec4  + \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ) - (\cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 confirmations\cf4 \strokec4  * \cf9 \strokec9 10\cf4 \strokec4  + \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4 ))\cb1 \
\cb3     .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 5\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractRealDiscussions\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 discussions\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 replyCount\cf4 \strokec4  = \cf7 \strokec7 countReplies\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4 );\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 score\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 replyCount\cf4 \strokec4  > \cf9 \strokec9 10\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 debateScore\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3       \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 supportScore\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4  && \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 replies\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 children\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 reply\cf4 \strokec4  => \{\cb1 \
\cb3           \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 reply\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4  && \cf7 \strokec7 reply\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 replyBody\cf4 \strokec4  = \cf7 \strokec7 reply\cf4 \strokec4 .\cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 toLowerCase\cf4 \strokec4 ();\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /\\b(disagree|wrong|actually|but|however)\\b/\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 replyBody\cf4 \strokec4 )) \{\cb1 \
\cb3               \cf7 \strokec7 debateScore\cf4 \strokec4 ++;\cb1 \
\cb3             \}\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /\\b(agree|exactly|this|yes|true)\\b/\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 replyBody\cf4 \strokec4 )) \{\cb1 \
\cb3               \cf7 \strokec7 supportScore\cf4 \strokec4 ++;\cb1 \
\cb3             \}\cb1 \
\cb3           \}\cb1 \
\cb3         \});\cb1 \
\cb3       \}\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 discussionType\cf4 \strokec4  = \cf7 \strokec7 debateScore\cf4 \strokec4  > \cf7 \strokec7 supportScore\cf4 \strokec4  ? \cf8 \strokec8 'debate'\cf4 \strokec4  : \cf8 \strokec8 'agreement'\cf4 \strokec4 ;\cb1 \
\cb3       \cb1 \
\cb3       \cf7 \strokec7 discussions\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3         \cf7 \strokec7 comment\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 200\cf4 \strokec4 ) + (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 200\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3         \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 replyCount\cf4 \strokec4 : \cf7 \strokec7 replyCount\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 discussionType\cf4 \strokec4 : \cf7 \strokec7 discussionType\cf4 \strokec4 ,\cb1 \
\cb3         \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \cb1 \strokec4 \
\cb3       \});\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 discussions\cf4 \strokec4 .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 replyCount\cf4 \strokec4  - \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 replyCount\cf4 \strokec4 ).\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 5\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractHiddenGems\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 gems\cf4 \strokec4  = [];\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 body\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 score\cf4 \strokec4  = \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 score\cf4 \strokec4  || \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf2 \strokec2 // Low score but high value\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 score\cf4 \strokec4  < \cf9 \strokec9 100\cf4 \strokec4  && \cf7 \strokec7 score\cf4 \strokec4  > \cf9 \strokec9 10\cf4 \strokec4  && \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 150\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 valueScore\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ;\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /\\b(pro tip|important|please read|source:|study shows|worked in|years of experience)\\b/\cf5 \strokec5 i\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \{\cb1 \
\cb3         \cf7 \strokec7 valueScore\cf4 \strokec4  += \cf9 \strokec9 2\cf4 \strokec4 ;\cb1 \
\cb3       \}\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /https?:\\/\\//\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \cf7 \strokec7 valueScore\cf4 \strokec4 ++;\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /\\n[-*\'95]|\\n\\d+\\./\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \cf7 \strokec7 valueScore\cf4 \strokec4 ++;\cb1 \
\cb3       \cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf7 \strokec7 valueScore\cf4 \strokec4  >= \cf9 \strokec9 2\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 gems\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{\cb1 \
\cb3           \cf7 \strokec7 content\cf4 \strokec4 : \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 substring\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 400\cf4 \strokec4 ) + (\cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 400\cf4 \strokec4  ? \cf8 \strokec8 '...'\cf4 \strokec4  : \cf8 \strokec8 ''\cf4 \strokec4 ),\cb1 \
\cb3           \cf7 \strokec7 author\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 score\cf4 \strokec4 : \cf7 \strokec7 score\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 valueScore\cf4 \strokec4 : \cf7 \strokec7 valueScore\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 permalink\cf4 \strokec4 : \cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 permalink\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 reason\cf4 \strokec4 : \cf7 \strokec7 identifyGemReason\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )\cb1 \
\cb3         \});\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 gems\cf4 \strokec4 .\cf7 \strokec7 sort\cf4 \strokec4 ((\cf7 \strokec7 a\cf4 \strokec4 , \cf7 \strokec7 b\cf4 \strokec4 ) => \cf7 \strokec7 b\cf4 \strokec4 .\cf7 \strokec7 valueScore\cf4 \strokec4  - \cf7 \strokec7 a\cf4 \strokec4 .\cf7 \strokec7 valueScore\cf4 \strokec4 ).\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 3\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 extractPatterns\cf4 \strokec4 (\cf7 \strokec7 comments\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 phrases\cf4 \strokec4  = \{\};\cb1 \
\cb3   \cb1 \
\cb3   \cf7 \strokec7 comments\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4  => \{\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 body\cf4 \strokec4  = (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 body\cf4 \strokec4  || \cf8 \strokec8 ''\cf4 \strokec4 ).\cf7 \strokec7 toLowerCase\cf4 \strokec4 ();\cb1 \
\cb3     \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 words\cf4 \strokec4  = \cf7 \strokec7 body\cf4 \strokec4 .\cf7 \strokec7 split\cf4 \strokec4 (\cf10 \strokec10 /\\s+/\cf4 \strokec4 ).\cf7 \strokec7 filter\cf4 \strokec4 (\cf7 \strokec7 w\cf4 \strokec4  => \cf7 \strokec7 w\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf9 \strokec9 3\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf2 \strokec2 // Look for 3-4 word phrases\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 for\cf4 \strokec4  (\cf5 \strokec5 let\cf4 \strokec4  \cf7 \strokec7 i\cf4 \strokec4  = \cf9 \strokec9 0\cf4 \strokec4 ; \cf7 \strokec7 i\cf4 \strokec4  < \cf7 \strokec7 words\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  - \cf9 \strokec9 3\cf4 \strokec4 ; \cf7 \strokec7 i\cf4 \strokec4 ++) \{\cb1 \
\cb3       \cf5 \strokec5 const\cf4 \strokec4  \cf7 \strokec7 phrase\cf4 \strokec4  = \cf7 \strokec7 words\cf4 \strokec4 .\cf7 \strokec7 slice\cf4 \strokec4 (\cf7 \strokec7 i\cf4 \strokec4 , \cf7 \strokec7 i\cf4 \strokec4  + \cf9 \strokec9 4\cf4 \strokec4 ).\cf7 \strokec7 join\cf4 \strokec4 (\cf8 \strokec8 ' '\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (!\cf7 \strokec7 phrases\cf4 \strokec4 [\cf7 \strokec7 phrase\cf4 \strokec4 ]) \{\cb1 \
\cb3         \cf7 \strokec7 phrases\cf4 \strokec4 [\cf7 \strokec7 phrase\cf4 \strokec4 ] = \{ \cf7 \strokec7 count\cf4 \strokec4 : \cf9 \strokec9 0\cf4 \strokec4 , \cf7 \strokec7 users\cf4 \strokec4 : \cf5 \strokec5 new\cf4 \strokec4  \cf6 \strokec6 Set\cf4 \strokec4 () \};\cb1 \
\cb3       \}\cb1 \
\cb3       \cf7 \strokec7 phrases\cf4 \strokec4 [\cf7 \strokec7 phrase\cf4 \strokec4 ].\cf7 \strokec7 count\cf4 \strokec4 ++;\cb1 \
\cb3       \cf7 \strokec7 phrases\cf4 \strokec4 [\cf7 \strokec7 phrase\cf4 \strokec4 ].\cf7 \strokec7 users\cf4 \strokec4 .\cf7 \strokec7 add\cf4 \strokec4 (\cf7 \strokec7 comment\cf4 \strokec4 .\cf7 \strokec7 author\cf4 \strokec4 );\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3   \cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 Object\cf4 \strokec4 .\cf7 \strokec7 entries\cf4 \strokec4 (\cf7 \strokec7 phrases\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 filter\cf4 \strokec4 (([\cf7 \strokec7 phrase\cf4 \strokec4 , \cf7 \strokec7 data\cf4 \strokec4 ]) => \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 users\cf4 \strokec4 .\cf7 \strokec7 size\cf4 \strokec4  >= \cf9 \strokec9 3\cf4 \strokec4 )\cb1 \
\cb3     .\cf7 \strokec7 map\cf4 \strokec4 (([\cf7 \strokec7 phrase\cf4 \strokec4 , \cf7 \strokec7 data\cf4 \strokec4 ]) => (\{\cb1 \
\cb3       \cf7 \strokec7 pattern\cf4 \strokec4 : \cf7 \strokec7 phrase\cf4 \strokec4 ,\cb1 \
\cb3       \cf7 \strokec7 mentionedBy\cf4 \strokec4 : \cf7 \strokec7 data\cf4 \strokec4 .\cf7 \strokec7 users\cf4 \strokec4 .\cf7 \strokec7 size\cf4 \strokec4  + \cf8 \strokec8 ' different users'\cf4 \cb1 \strokec4 \
\cb3     \}))\cb1 \
\cb3     .\cf7 \strokec7 slice\cf4 \strokec4 (\cf9 \strokec9 0\cf4 \strokec4 , \cf9 \strokec9 10\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Helper function\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 function\cf4 \strokec4  \cf7 \strokec7 identifyGemReason\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /\\b(source:|study shows|research shows)\\b/\cf5 \strokec5 i\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 'Contains sources/research'\cf4 \strokec4 ;\cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /\\b(former|used to be|worked in|years of experience)\\b/\cf5 \strokec5 i\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 'Expert perspective'\cf4 \strokec4 ;\cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /\\b(saved me|changed my life|wish I knew)\\b/\cf5 \strokec5 i\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 'Life-changing advice'\cf4 \strokec4 ;\cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /\\n[-*\'95]|\\n\\d+\\./\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 'Detailed breakdown'\cf4 \strokec4 ;\cb1 \
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 /https?:\\/\\//\cf4 \strokec4 .\cf7 \strokec7 test\cf4 \strokec4 (\cf7 \strokec7 body\cf4 \strokec4 )) \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 'Includes resources'\cf4 \strokec4 ;\cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 'Valuable insight'\cf4 \strokec4 ;\cb1 \
\cb3 \}\cb1 \
}